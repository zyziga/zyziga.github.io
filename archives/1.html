<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>瑞吉外卖-Day02 | 姜小白程序</title><meta name="author" content="姜小白"><meta name="copyright" content="姜小白"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="瑞吉外卖-Day02课程内容 完善登录功能 新增员工 员工信息分页查询 启用&#x2F;禁用员工账号 编辑员工信息  分析前端页面效果是如何实现的 为什么点击左边 右边会根着变化  首先 我们先来看一下菜单是如何展示出来的 在来看一下 为啥点击菜单时 右边会跟着变 第一 ：菜单是如何展示出来的  我们在创建一个VUE对象的时候 在我们的 data() 的位置 我们准备了 menuList: []">
<meta property="og:type" content="article">
<meta property="og:title" content="瑞吉外卖-Day02">
<meta property="og:url" content="https://zyziga.github.io/archives/1.html">
<meta property="og:site_name" content="姜小白程序">
<meta property="og:description" content="瑞吉外卖-Day02课程内容 完善登录功能 新增员工 员工信息分页查询 启用&#x2F;禁用员工账号 编辑员工信息  分析前端页面效果是如何实现的 为什么点击左边 右边会根着变化  首先 我们先来看一下菜单是如何展示出来的 在来看一下 为啥点击菜单时 右边会跟着变 第一 ：菜单是如何展示出来的  我们在创建一个VUE对象的时候 在我们的 data() 的位置 我们准备了 menuList: []">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg2.png">
<meta property="article:published_time" content="2023-04-01T11:30:00.000Z">
<meta property="article:modified_time" content="2023-06-14T13:26:23.703Z">
<meta property="article:author" content="姜小白">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg2.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zyziga.github.io/archives/1.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"该文章创建于","messageNext":"天前，请以最新文章为准."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":50},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 姜小白","link":"链接: ","source":"来源: 姜小白程序","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '瑞吉外卖-Day02',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-14 21:26:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-categories-card/lib/categorybar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/milos.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg2.png')"><nav id="nav"><span id="blog-info"><a href="/" title="姜小白程序"><span class="site-name">姜小白程序</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">瑞吉外卖-Day02</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-01T11:30:00.000Z" title="发表于 2023-04-01 19:30:00">2023-04-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-14T13:26:23.703Z" title="更新于 2023-06-14 21:26:23">2023-06-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">24.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>88分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="瑞吉外卖-Day02"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="瑞吉外卖-Day02"><a href="#瑞吉外卖-Day02" class="headerlink" title="瑞吉外卖-Day02"></a>瑞吉外卖-Day02</h1><h2 id="课程内容"><a href="#课程内容" class="headerlink" title="课程内容"></a>课程内容</h2><ul>
<li>完善登录功能</li>
<li>新增员工</li>
<li>员工信息分页查询</li>
<li>启用&#x2F;禁用员工账号</li>
<li>编辑员工信息</li>
</ul>
<p>分析前端页面效果是如何实现的</p>
<p>为什么点击左边 右边会根着变化</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092100003.png" alt="图1"></p>
<p>首先 我们先来看一下菜单是如何展示出来的 在来看一下 为啥点击菜单时 右边会跟着变</p>
<p>第一 ：菜单是如何展示出来的</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092101695.png" alt="图2"></p>
<p>我们在创建一个VUE对象的时候 在我们的 data() 的位置 我们准备了 menuList: [] 的一个数据   menuList: [] 是一个数组对象 </p>
<p>数组对象里面放着一个个JSON数据    而每一个JSON数据里面又放着id name url icon(图标)   以上只是数据的准备 并不是定义就可以展示到菜单的一个位置</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">defAct</span>: <span class="string">&#x27;2&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">menuActived</span>: <span class="string">&#x27;2&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">userInfo</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">menuList</span>: [</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// &#123;</span></span></span><br><span class="line"><span class="language-javascript">              <span class="comment">//   id: &#x27;1&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">              <span class="comment">//   name: &#x27;门店管理&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">              <span class="comment">//   children: [</span></span></span><br><span class="line"><span class="language-javascript">                  &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">id</span>: <span class="string">&#x27;2&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>: <span class="string">&#x27;员工管理&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>: <span class="string">&#x27;page/member/list.html&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">icon</span>: <span class="string">&#x27;icon-member&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;,</span></span><br><span class="line"><span class="language-javascript">                  &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">id</span>: <span class="string">&#x27;3&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>: <span class="string">&#x27;分类管理&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>: <span class="string">&#x27;page/category/list.html&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">icon</span>: <span class="string">&#x27;icon-category&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;,</span></span><br><span class="line"><span class="language-javascript">                  &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">id</span>: <span class="string">&#x27;4&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>: <span class="string">&#x27;菜品管理&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>: <span class="string">&#x27;page/food/list.html&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">icon</span>: <span class="string">&#x27;icon-food&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;,</span></span><br><span class="line"><span class="language-javascript">                  &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">id</span>: <span class="string">&#x27;5&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>: <span class="string">&#x27;套餐管理&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>: <span class="string">&#x27;page/combo/list.html&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">icon</span>: <span class="string">&#x27;icon-combo&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;,</span></span><br><span class="line"><span class="language-javascript">                  &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">id</span>: <span class="string">&#x27;6&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>: <span class="string">&#x27;订单明细&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>: <span class="string">&#x27;page/order/list.html&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">icon</span>: <span class="string">&#x27;icon-order&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">//   ],</span></span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// &#125;,</span></span></span><br><span class="line"><span class="language-javascript">            ],</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">iframeUrl</span>: <span class="string">&#x27;page/member/list.html&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">headTitle</span>: <span class="string">&#x27;员工管理&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">goBackFlag</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">loading</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">timer</span>: <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">computed</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> userInfo = <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (userInfo) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">userInfo</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(userInfo)</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">closeLoading</span>()</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">          <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">timer</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">window</span>.<span class="property">menuHandle</span> = <span class="variable language_">this</span>.<span class="property">menuHandle</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">logout</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">logoutApi</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;<span class="number">00</span></span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span>(res.<span class="property">code</span> === <span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/backend/page/login/login.html&#x27;</span></span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">goBack</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// window.location.href = &#x27;javascript:history.go(-1)&#x27;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> menu = <span class="variable language_">this</span>.<span class="property">menuList</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span>=&gt;</span>item.<span class="property">id</span>===<span class="variable language_">this</span>.<span class="property">menuActived</span>)</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// this.goBackFlag = false</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// this.headTitle = menu.name</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="title function_">menuHandle</span>(menu,<span class="literal">false</span>)</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">menuHandle</span>(<span class="params">item, goBackFlag</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">menuActived</span> = item.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">iframeUrl</span> = item.<span class="property">url</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">headTitle</span> = item.<span class="property">name</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">goBackFlag</span> = goBackFlag</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="title function_">closeLoading</span>()</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">closeLoading</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,<span class="number">1000</span>)</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092315688.png" alt="图3"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">menuList: [    menuList: [] 是一个数组对象 数组对象       //120行</span><br><span class="line">                   </span><br><span class="line">                 &#123;                      里面放着一个个JSON数据</span><br><span class="line">                   id: &#x27;2&#x27;,           每一个JSON数据里面又放着id name url icon(图标) </span><br><span class="line">                   name: &#x27;员工管理&#x27;,</span><br><span class="line">                   url: &#x27;page/member/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-member&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;3&#x27;,</span><br><span class="line">                   name: &#x27;分类管理&#x27;,</span><br><span class="line">                   url: &#x27;page/category/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-category&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;4&#x27;,</span><br><span class="line">                   name: &#x27;菜品管理&#x27;,</span><br><span class="line">                   url: &#x27;page/food/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-food&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;5&#x27;,</span><br><span class="line">                   name: &#x27;套餐管理&#x27;,</span><br><span class="line">                   url: &#x27;page/combo/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-combo&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;6&#x27;,</span><br><span class="line">                   name: &#x27;订单明细&#x27;,</span><br><span class="line">                   url: &#x27;page/order/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-order&#x27;</span><br><span class="line">                 &#125;</span><br><span class="line">             //   ],</span><br><span class="line">             // &#125;,</span><br><span class="line">           ],</span><br></pre></td></tr></table></figure>

<p>name 有的是’员工管理’, ‘分类管理’,  ‘菜品管理’,  ‘套餐管理’,  ‘订单明细’,    对应的就是我们下图所示、</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092310501.png" alt="图4"></p>
<p>以上只是数据的准备 并不是定义就可以展示到菜单的一个位置</p>
<p>第二   怎么展示到菜单的位置</p>
<p>请到第39行 用到了el-menu组件 下面的v-for表示在遍历 遍历menuList</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-submenu :index=&quot;item.id&quot; v-if=&quot;item.children &amp;&amp; item.children.length&gt;0&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>这里面的 v-if是不会成立的 但是会执行第64行&lt;el-menu-item v-else :index&#x3D;”item.id” @click&#x3D;”menuHandle(item,false)”&gt;这个分支 然后就可以把<span slot="title"></span> item.name给展示出来 </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-menu</span>             //<span class="attr">菜单组件</span></span></span><br><span class="line"><span class="tag">             <span class="attr">:default-active</span>=<span class="string">&quot;defAct&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">:unique-opened</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">:collapse-transition</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">background-color</span>=<span class="string">&quot;#343744&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">text-color</span>=<span class="string">&quot;#bfcbd9&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">active-text-color</span>=<span class="string">&quot;#f4f4f5&quot;</span></span></span><br><span class="line"><span class="tag">           &gt;</span>     //item不是固定写法</span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;item in menuList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>    //v-for表示在遍历 遍历menuList</span><br><span class="line">                 //判断item里面有没有children属性和children属性的length是否大于0</span><br><span class="line">                 //我们往下看到第126那里的每一项都没有我们的children</span><br><span class="line">              // 但是会执行第64行<span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">v-else</span> <span class="attr">:index</span>=<span class="string">&quot;item.id&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;menuHandle(item,false)&quot;</span>&gt;</span>这个分支                  // 然后就可以把第66行的item.name给展示出来 如果我们把id修改成Id</span><br><span class="line">               <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">:index</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.children &amp;&amp; item.children.length&gt;0&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;item.icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">el-menu-item</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">v-for</span>=<span class="string">&quot;sub in item.children&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">:index</span>=<span class="string">&quot;sub.id&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">:key</span>=<span class="string">&quot;sub.id&quot;</span></span></span><br><span class="line"><span class="tag">                   @<span class="attr">click</span>=<span class="string">&quot;menuHandle(sub,false)&quot;</span></span></span><br><span class="line"><span class="tag">                   &gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">i</span> <span class="attr">:class</span>=<span class="string">&quot;iconfont&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;sub.icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123;sub.name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                   &lt;/el-menu-item</span><br><span class="line">                 &gt;</span><br><span class="line">               <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span></span><br><span class="line">     //64行          <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">v-else</span> <span class="attr">:index</span>=<span class="string">&quot;item.id&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;menuHandle(item,false)&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;item.icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  //66行               <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>     //把item.name给展示出来</span><br><span class="line">               <span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092338082.png" alt="图5"></p>
<p> 所以我们看到的就是以下的名称</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092342199.png" alt="图6"></p>
<p>如果我们把name修改成id</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092342644.png" alt="图7"></p>
<p>重启    刷新</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092342382.png" alt="图8"></p>
<p>为什么是Id 因为由这个对象数组menuList:[]决定</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092343390.png" alt="图9"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">`new Vue(&#123;</span><br><span class="line">        el: &#x27;#app&#x27;,</span><br><span class="line">        data() &#123;</span><br><span class="line">          return &#123;</span><br><span class="line">            defAct: &#x27;2&#x27;,</span><br><span class="line">            menuActived: &#x27;2&#x27;,</span><br><span class="line">            userInfo: &#123;&#125;,</span><br><span class="line">            menuList: [</span><br><span class="line">              // &#123;</span><br><span class="line">              //   id: &#x27;1&#x27;,</span><br><span class="line">              //   name: &#x27;门店管理&#x27;,</span><br><span class="line">              //   children: [</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: &#x27;2&#x27;,</span><br><span class="line">                    name: &#x27;员工管理&#x27;,</span><br><span class="line">                    url: &#x27;page/member/list.html&#x27;,</span><br><span class="line">                    icon: &#x27;icon-member&#x27;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: &#x27;3&#x27;,</span><br><span class="line">                    name: &#x27;分类管理&#x27;,</span><br><span class="line">                    url: &#x27;page/category/list.html&#x27;,</span><br><span class="line">                    icon: &#x27;icon-category&#x27;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: &#x27;4&#x27;,</span><br><span class="line">                    name: &#x27;菜品管理&#x27;,</span><br><span class="line">                    url: &#x27;page/food/list.html&#x27;,</span><br><span class="line">                    icon: &#x27;icon-food&#x27;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: &#x27;5&#x27;,</span><br><span class="line">                    name: &#x27;套餐管理&#x27;,</span><br><span class="line">                    url: &#x27;page/combo/list.html&#x27;,</span><br><span class="line">                    icon: &#x27;icon-combo&#x27;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: &#x27;6&#x27;,</span><br><span class="line">                    name: &#x27;订单明细&#x27;,</span><br><span class="line">                    url: &#x27;page/order/list.html&#x27;,</span><br><span class="line">                    icon: &#x27;icon-order&#x27;</span><br><span class="line">                  &#125;</span><br><span class="line">              //   ],</span><br><span class="line">              // &#125;,</span><br><span class="line">            ],</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092344576.png" alt="图10"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304092355994.png" alt="图11"></p>
<p>第三 ： 点击菜单时 右边会跟着变</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://localhost:8080/backend/index.html</span><br></pre></td></tr></table></figure>

<p>这些菜单实际上都加了一个@click事件 当我们点击菜单的事情 他会执行menuHandle() 方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-menu-item v-else :index=&quot;item.id&quot; @click=&quot;menuHandle(item,false)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306042122736.png" alt="图12"></p>
<p>然后把item,false传过来 接下来我们找到menuHandle() 方法 在196行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">menuHandle(item, goBackFlag) &#123;</span><br><span class="line">            this.loading = true</span><br><span class="line">            this.menuActived = item.id</span><br><span class="line">            this.iframeUrl = item.url</span><br><span class="line">            this.headTitle = item.name</span><br><span class="line">            this.goBackFlag = goBackFlag</span><br><span class="line">            this.closeLoading()</span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure>

<p>当我们点击菜单的时候 就会执行menuHandle() 方法 这里面最重要的是 this.iframeUrl &#x3D; item.url</p>
<p> 这里面的url就是以下的url(128行)      也就是点击菜单的url</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">menuList: [</span><br><span class="line">             // &#123;</span><br><span class="line">             //   id: &#x27;1&#x27;,</span><br><span class="line">             //   name: &#x27;门店管理&#x27;,</span><br><span class="line">             //   children: [</span><br><span class="line">                 &#123;</span><br><span class="line">                   id:&#x27;2&#x27;,</span><br><span class="line">                   name : &#x27;员工管理&#x27;,</span><br><span class="line">                   url: &#x27;page/member/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-member&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;3&#x27;,</span><br><span class="line">                   name: &#x27;分类管理&#x27;,</span><br><span class="line">                   url: &#x27;page/category/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-category&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;4&#x27;,</span><br><span class="line">                   name: &#x27;菜品管理&#x27;,</span><br><span class="line">                   url: &#x27;page/food/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-food&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;5&#x27;,</span><br><span class="line">                   name: &#x27;套餐管理&#x27;,</span><br><span class="line">                   url: &#x27;page/combo/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-combo&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;6&#x27;,</span><br><span class="line">                   name: &#x27;订单明细&#x27;,</span><br><span class="line">                   url: &#x27;page/order/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-order&#x27;</span><br><span class="line">                 &#125;</span><br><span class="line">             //   ],</span><br><span class="line">             // &#125;,</span><br><span class="line">           ],</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304100024943.png" alt="图13"></p>
<p>这里面是通过iframeUrl的方式来显示新的页面</p>
<p>iframeUrl在第158行定义的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iframeUrl: &#x27;page/member/list.html&#x27;,</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304100026960.png" alt="image-20230410002610988"></p>
<p>在什么地方会用到iframeUrl呢？</p>
<p>在第89行用到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;iframe&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<p> 这个是用来展示一个新的页面的 而这个页面从哪里来呢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;iframe         //用来展示一个新的页面</span><br><span class="line">  id=&quot;cIframe&quot;</span><br><span class="line">  class=&quot;c_iframe&quot;</span><br><span class="line">  name=&quot;cIframe&quot;</span><br><span class="line">  :src=&quot;iframeUrl&quot;</span><br><span class="line">  width=&quot;100%&quot;</span><br><span class="line">  height=&quot;auto&quot;</span><br><span class="line">  frameborder=&quot;0&quot;</span><br><span class="line">  v-show=&quot;!loading&quot;</span><br><span class="line">&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306042130131.png" alt="image-20230410002952927"></p>
<p>这个相当于说在我们的页面上挖了一个坑</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304100031207.png" alt="image-20230410003115103"></p>
<p>而这个页面从哪里来呢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;iframe</span><br><span class="line">             id=&quot;cIframe&quot;</span><br><span class="line">             class=&quot;c_iframe&quot;</span><br><span class="line">             name=&quot;cIframe&quot;</span><br><span class="line">             :src=&quot;iframeUrl&quot;   这个地方传进什么数据  展示的就是什么数据</span><br><span class="line">             width=&quot;100%&quot;</span><br><span class="line">             height=&quot;auto&quot;</span><br><span class="line">             frameborder=&quot;0&quot;</span><br><span class="line">             v-show=&quot;!loading&quot;</span><br><span class="line">           &gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304100036024.png" alt="image-20230410003635226"></p>
<p>为什么我们登录之后 展示的是员工管理 而不是分类管理或是其他</p>
<p>这是因为我们给iframeUrl一个初始值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iframeUrl: &#x27;page/member/list.html&#x27;,</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131532352.png" alt="image-20230410003846840"></p>
<p>而我们在点击菜单的时候 其实是在切换url</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">menuHandle(item, goBackFlag) &#123;</span><br><span class="line">      this.loading = true</span><br><span class="line">      this.menuActived = item.id</span><br><span class="line">      this.iframeUrl = item.url</span><br><span class="line">      this.headTitle = item.name</span><br><span class="line">      this.goBackFlag = goBackFlag</span><br><span class="line">      this.closeLoading()</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131532890.png" alt="image-20230410004029272"></p>
<p>比如说我们现在初始页面给修改成以下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iframeUrl: &#x27;http://www.itcast.c</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304100042224.png" alt="image-20230410004214015"></p>
<p>重启 刷新</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131532565.png" alt="image-20230410004253475"></p>
<p>所以当我们点击菜单的时候 其实他是在切换url地址</p>
<p>而这个url地址在数据准备的时候就已经写好了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">menuList: [</span><br><span class="line">             // &#123;</span><br><span class="line">             //   id: &#x27;1&#x27;,</span><br><span class="line">             //   name: &#x27;门店管理&#x27;,</span><br><span class="line">             //   children: [</span><br><span class="line">                 &#123;</span><br><span class="line">                   id:&#x27;2&#x27;,</span><br><span class="line">                   name : &#x27;员工管理&#x27;,</span><br><span class="line">                   url: &#x27;page/member/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-member&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;3&#x27;,</span><br><span class="line">                   name: &#x27;分类管理&#x27;,</span><br><span class="line">                   url: &#x27;page/category/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-category&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;4&#x27;,</span><br><span class="line">                   name: &#x27;菜品管理&#x27;,</span><br><span class="line">                   url: &#x27;page/food/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-food&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;5&#x27;,</span><br><span class="line">                   name: &#x27;套餐管理&#x27;,</span><br><span class="line">                   url: &#x27;page/combo/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-combo&#x27;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   id: &#x27;6&#x27;,</span><br><span class="line">                   name: &#x27;订单明细&#x27;,</span><br><span class="line">                   url: &#x27;page/order/list.html&#x27;,</span><br><span class="line">                   icon: &#x27;icon-order&#x27;</span><br><span class="line">                 &#125;</span><br><span class="line">             //   ],</span><br><span class="line">             // &#125;,</span><br><span class="line">           ],</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304100044727.png" alt="image-20230410004454139"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533573.png" alt="image-20230410004631599"></p>
<p>不同菜单对应不同的页面      所以当我们点击某一个菜单的时候   他其实是切换到了相应的页面</p>
<h2 id="1-完善登录功能"><a href="#1-完善登录功能" class="headerlink" title="1. 完善登录功能"></a>1. 完善登录功能</h2><h3 id="1-1-问题分析"><a href="#1-1-问题分析" class="headerlink" title="1.1 问题分析"></a>1.1 问题分析</h3><p>前面我们已经完成了后台系统的员工登录功能开发，但是目前还存在一个问题，接下来我们来说明一个这个问题， 以及如何处理。</p>
<p><strong>1). 目前现状</strong></p>
<p>用户如果不登录，直接访问系统首页面，照样可以正常访问。 </p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021756260.png" alt="image-20210727232226862"> </p>
<p><strong>2). 理想效果</strong></p>
<p>上述这种设计并不合理，我们希望看到的效果应该 是，只有登录成功后才可以访问系统中的页面，如果没有登录, 访问系统中的任何界面都直接跳转到登录页面。</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021801653.png" alt="image-20210727232747276" style="zoom:80%;" /> 



<p><strong>那么，具体应该怎么实现呢？</strong></p>
<p>可以使用我们之前讲解过的 过滤器、拦截器来实现，在过滤器、拦截器中拦截前端发起的请求，判断用户是否已经完成登录，如果没有登录则返回提示信息，跳转到登录页面。</p>
<h3 id="1-2-思路分析"><a href="#1-2-思路分析" class="headerlink" title="1.2 思路分析"></a>1.2 思路分析</h3><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021801140.png" alt="image-20210727233554707" style="zoom:80%;" /> 

<p><strong>过滤器具体的处理逻辑如下：</strong></p>
<p>A. 获取本次请求的URI</p>
<p>B. 判断本次请求, 是否需要登录, 才可以访问</p>
<p>C. 如果不需要，则直接放行</p>
<p>D. 判断登录状态，如果已登录，则直接放行</p>
<p>E. 如果未登录, 则返回未登录结果</p>
<p>如果未登录,我们需要给前端返回什么样的结果呢? 这个时候, 我们可以去看看前端是如何处理的 ?</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802780.png" alt="image-20210728001324901" style="zoom:80%;" /> 



<h3 id="1-3-代码实现"><a href="#1-3-代码实现" class="headerlink" title="1.3 代码实现"></a>1.3 代码实现</h3><p>实现步骤：<br>1、创建自定义过滤器LoginCheckFilter<br>2、在启动类上加入注解@ServletComponentScan<br>3、完善过滤器的处理逻辑</p>
<p><strong>1). 定义登录校验过滤器</strong></p>
<p>自定义一个过滤器 LoginCheckFilter 并实现 Filter 接口, 在doFilter方法中完成校验的逻辑。 那么接下来, 我们就根据上述分析的步骤, 来完成具体的功能代码实现: </p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533933.png" alt="image-20230410010750497"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533981.png" alt="image-20230410010944730"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.reggie.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*检查用户是否已经完成登录*/</span></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;loginCheckFilter&quot;,urlPatterns = &quot;/*&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//强转</span></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line">        log.info(<span class="string">&quot;拦截到请求：&#123;&#125;&quot;</span>,request.getRequestURI());</span><br><span class="line">          <span class="comment">//放行</span></span><br><span class="line">        filterChain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533111.png" alt="image-20230410012037639"></p>
<p>重启</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533957.png" alt="image-20230410012156708"></p>
<p> 刷新</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533781.png" alt="image-20230410012317239"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131533156.png" alt="image-20230410012420126"></p>
<p>代码解释：</p>
<p>解释一  </p>
<p>这段代码是一个 Java Web 应用程序中的过滤器(Filter)。 过滤器在请求到达目标 Servlet&#x2F;JSP 前预处理请求或响应，以便在处理真正的请求之前完成一些操作。</p>
<p>这个过滤器的作用是检查用户是否已经登录，通过检查URL是否以登录用户的认证信息，如session ID、token等。如果用户没有登录，过滤器会将用户重定向到登录页面，如果用户已经登录，则请求将被放行到下一个处理程序。</p>
<p>具体来说，这个过滤器实现了Filter过滤器接口中的doFilter方法。该方法接收ServletRequest和ServletResponse类型的参数，并通过类型转换将其转换为HttpServletRequest和HttpServletResponse类型。然后，它会打印一条日志以表明请求已经被拦截，并将请求和响应对象传递给过滤器链(FilterChain)。最后，过滤器链将请求和响应对象传递给下一个处理程序。</p>
<p>总之，这个过滤器是一个很有用的工具，它能够在用户请求到达目标 Servlet&#x2F;JSP 之前进行预处理，确保用户已经完成登录并且已经得到授权，从而保护Web应用程序的安全性。</p>
<p>解释二</p>
<p>当我们使用一个 Java Web 应用程序时，需要确保用户已经完成登录，并且已经得到授权，否则他们将无法访问需要特殊权限的页面。这就是这段代码的作用。</p>
<p>这段代码实现了一个过滤器(Filter)，它会在请求到达目标 Servlet&#x2F;JSP 之前进行预处理。它会检查用户是否已经完成登录，如果没有完成登录，它会将用户重定向到登录页面，以便用户能够完成登录，然后再次尝试访问需要特殊权限的页面。</p>
<p>这个过滤器检查请求的 URL，如果 URL 包含了用户的认证信息，比如 session ID 或者 token，那么它就认为用户已经完成了登录。如果用户没有完成登录，它就会重定向到登录页面，让用户完成登录。</p>
<p>这个过滤器的实现比较简单，它实现了 Filter 接口中的 doFilter 方法。当有请求到达时，它会将请求转换为 HttpServletRequest 对象，并检查是否已经完成登录。如果已经完成登录，它就会将请求和响应对象传递给下一个处理程序。如果没有完成登录，它就会将用户重定向到登录页面。</p>
<p>总之，这个过滤器是一个很有用的工具，它能够确保用户已经完成登录，并且已经得到授权，从而保护 Web 应用程序的安全性。</p>
<p>解释三</p>
<p>这段代码是一个 Java Web 应用程序中的过滤器(Filter)，它的作用是在用户访问任何网页之前检查用户是否已经完成登录操作。</p>
<p>在代码中，使用了 @WebFilter 注解，指定了过滤器的名称为 “loginCheckFilter”，并将其应用于所有的 URL，即 “&#x2F;*”。</p>
<p>在 doFilter() 方法中，将传入的 ServletRequest 和 ServletResponse 对象转换为 HttpServletRequest 和 HttpServletResponse 对象，并记录下当前请求的 URL 地址，最后将请求和响应对象交给 FilterChain 继续处理。</p>
<p>Filter 的作用类似于一个拦截器，当用户访问任何网页时，该过滤器会首先拦截请求，检查用户是否已经登录，如果用户已经完成了登录操作，那么该过滤器会放行请求，让用户继续访问该网页；如果用户还没有登录，那么该过滤器会重定向到登录页面，要求用户先完成登录操作，然后才能继续访问网页。</p>
<p>总的来说，这段代码的作用是保护 Web 应用程序中的敏感资源，确保只有已经完成登录操作的用户才能访问这些资源，提高了系统的安全性。</p>
<p>理解 ：在这个代码中为什么要进行强转</p>
<p>在这个代码中，我们将 ServletRequest 和 ServletResponse 对象转换为了 HttpServletRequest 和 HttpServletResponse 对象，这是因为 Filter 接口的 doFilter 方法接收的是 ServletRequest 和 ServletResponse 对象，而我们需要使用 HttpServletRequest 和 HttpServletResponse 对象来获取 HTTP 请求和响应的相关信息。</p>
<p>ServletRequest 和 ServletResponse 是 Java Servlet 规范中定义的接口，它们提供了一种通用的处理 HTTP 请求和响应的方式。但是它们缺少 HttpServletRequest 和 HttpServletResponse 对象的一些方法，例如 getParameter 和 getAttribute 等方法，这些方法是在 HttpServletRequest 和 HttpServletResponse 接口中定义的。</p>
<p>因此，为了能够使用这些特定的方法，我们需要将 ServletRequest 和 ServletResponse 对象强制转换为 HttpServletRequest 和 HttpServletResponse 对象，这样就可以使用这些特定的方法了。但是，在进行强制转换之前，我们需要确保请求确实是 HTTP 请求，否则强制转换可能会导致类型转换异常。</p>
<p>两个注解：@WebFilter 和 @Slf4j的解释</p>
<p>@WebFilter 注解用于标记一个类为过滤器(Filter)，它可以指定过滤器的名称(filterName)和 URL 模式(urlPatterns)。在这个例子中，我们将这个过滤器的名称设置为 “loginCheckFilter”，并指定了 URL 模式为 “&#x2F;*”，也就是拦截所有的请求。</p>
<p>@Slf4j 注解是 Lombok 框架中提供的注解之一，它用于简化日志记录的代码。它会在编译时自动生成一个名为 “log” 的日志记录器，我们可以使用它来记录日志。在这个例子中，我们使用 log.info 方法来记录日志信息。</p>
<p>这些注解都是用来帮助我们更方便地编写代码和实现功能的。@WebFilter 注解让我们更容易地定义一个过滤器，并指定需要拦截的请求。@Slf4j 注解则帮助我们更方便地实现日志记录功能。</p>
<p>每行代码的详细解释</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@WebFilter(filterName = &quot;loginCheckFilter&quot;, urlPatterns = &quot;/*&quot;)</span><br></pre></td></tr></table></figure>

<p>这行代码是使用 @WebFilter 注解声明一个过滤器，并指定了过滤器的名称为 “loginCheckFilter”，并将其应用于所有的 URL，即 “&#x2F;*”。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@Slf4j</span><br></pre></td></tr></table></figure>

<p>这行代码使用了 Lombok 提供的 @Slf4j 注解，自动生成了一个名为 log 的日志对象，可以用它来输出日志信息。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class LoginCheckFilter implements Filter &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>这行代码是 doFilter() 方法的声明，该方法是 Filter 接口中的一个方法，用于拦截用户请求，并进行处理。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br></pre></td></tr></table></figure>

<p>这行代码将传入的 ServletRequest 和 ServletResponse 对象转换为 HttpServletRequest 和 HttpServletResponse 对象，以便后续对请求和响应进行处理。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">log.info(&quot;拦截到请求：&#123;&#125;&quot;, request.getRequestURI());</span><br></pre></td></tr></table></figure>

<p>这行代码使用之前定义的 log 对象输出一条日志信息，记录下当前请求的 URL 地址，方便后续的调试和问题定位。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filterChain.doFilter(request, response);</span><br></pre></td></tr></table></figure>

<p>这行代码调用 FilterChain 对象的 doFilter() 方法，将处理过的请求和响应对象传递给下一个过滤器或 Servlet 进行处理，如果没有其他过滤器，则直接交给 Servlet 处理。这样，过滤器的链条就得以形成，确保每个请求都会被多个过滤器进行处理。</p>
<p>复习过滤器filter</p>
<p>解释一</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTP Request --&gt; Filter 1 --&gt; Filter 2 --&gt; ... --&gt; Filter n --&gt; Servlet --&gt; HTTP Response</span><br></pre></td></tr></table></figure>

<p>在Java Web应用程序中，过滤器(Filter)是一个用于处理HTTP请求和响应的组件。它们被用来拦截请求并根据需要修改请求参数、头信息或请求体，以及响应信息。过滤器可以在 Servlet 执行之前或之后进行处理，也可以在 Servlet 进行处理时同时进行处理。</p>
<p>当一个HTTP请求到达Servlet容器时，它会首先被任何注册的过滤器拦截。过滤器根据需要可以更改请求，或者将请求传递给下一个过滤器。一旦所有过滤器都已处理请求，最终的目标Servlet会被调用。Servlet处理请求后生成响应，该响应会通过相同的过滤器链进行处理，并且在每个过滤器处可以修改响应。</p>
<p>这个过滤器链的顺序是在web.xml文件中定义的，并且过滤器可以动态添加或删除。这使得开发人员可以根据需要自定义请求处理流程，从而实现更加灵活和复杂的应用程序功能。</p>
<p>所属包: com.itheima.reggie.filter</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.itheima.reggie.common.R;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.AntPathMatcher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查用户是否已经完成登录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;loginCheckFilter&quot;,urlPatterns = &quot;/*&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span>&#123;</span><br><span class="line">    <span class="comment">//路径匹配器，支持通配符</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">AntPathMatcher</span> <span class="variable">PATH_MATCHER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AntPathMatcher</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1、获取本次请求的URI</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();<span class="comment">// /backend/index.html</span></span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;拦截到请求：&#123;&#125;&quot;</span>,requestURI);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//定义不需要处理的请求路径</span></span><br><span class="line">        String[] urls = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">                <span class="string">&quot;/employee/login&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/employee/logout&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/backend/**&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/front/**&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//2、判断本次请求是否需要处理</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">check</span> <span class="operator">=</span> check(urls, requestURI);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、如果不需要处理，则直接放行</span></span><br><span class="line">        <span class="keyword">if</span>(check)&#123;</span><br><span class="line">            log.info(<span class="string">&quot;本次请求&#123;&#125;不需要处理&quot;</span>,requestURI);</span><br><span class="line">            filterChain.doFilter(request,response);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//4、判断登录状态，如果已登录，则直接放行</span></span><br><span class="line">        <span class="keyword">if</span>(request.getSession().getAttribute(<span class="string">&quot;employee&quot;</span>) != <span class="literal">null</span>)&#123;</span><br><span class="line">            log.info(<span class="string">&quot;用户已登录，用户id为：&#123;&#125;&quot;</span>,request.getSession().getAttribute(<span class="string">&quot;employee&quot;</span>));</span><br><span class="line">            filterChain.doFilter(request,response);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;用户未登录&quot;</span>);</span><br><span class="line">        <span class="comment">//5、如果未登录则返回未登录结果，通过输出流方式向客户端页面响应数据</span></span><br><span class="line">        response.getWriter().write(JSON.toJSONString(R.error(<span class="string">&quot;NOTLOGIN&quot;</span>)));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 路径匹配，检查本次请求是否需要放行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> urls</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestURI</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String[] urls,String requestURI)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (String url : urls) &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">match</span> <span class="operator">=</span> PATH_MATCHER.match(url, requestURI);</span><br><span class="line">            <span class="keyword">if</span>(match)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><font color='red'><b>AntPathMatcher 拓展:</b></font></p>
<p><strong>介绍:</strong> Spring中提供的路径匹配器 ;</p>
<p><strong>通配符规则:</strong> 		</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>?</td>
<td>匹配一个字符</td>
</tr>
<tr>
<td>*</td>
<td>匹配0个或多个字符</td>
</tr>
<tr>
<td>**</td>
<td>匹配0个或多个目录&#x2F;字符</td>
</tr>
</tbody></table>
</blockquote>
<p><strong>2). 开启组件扫描</strong></p>
<p>需要在引导类上, 加上Servlet组件扫描的注解, 来扫描过滤器配置的@WebFilter注解， 扫描上之后， 过滤器在运行时就生效了。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ServletComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReggieApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ReggieApplication.class,args);</span><br><span class="line">        log.info(<span class="string">&quot;项目启动成功...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><font color='red'><b>@ServletComponentScan 的作用: </b></font></p>
<p>​	在SpringBoot项目中, 在引导类&#x2F;配置类上加了该注解后, 会自动扫描项目中(当前包及其子包下)的@WebServlet , @WebFilter , @WebListener 注解, 自动注册Servlet的相关组件 ;</p>
</blockquote>
<h3 id="1-4-功能测试"><a href="#1-4-功能测试" class="headerlink" title="1.4 功能测试"></a>1.4 功能测试</h3><p>当我们直接输入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://localhost:8080/backend/login.html</span><br></pre></td></tr></table></figure>

<p>时 </p>
<p>会跳转到登录界面</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://localhost:8080/backend/page/login/login.html</span><br></pre></td></tr></table></figure>



<p>视频的前端JS和我们实际的前端不同</p>
<p>代码编写完毕之后，我们需要将工程重启一下，然后在浏览器地址栏直接输入系统管理后台首页，然后看看是否可以跳转到登录页面即可。我们也可以通过debug的形式来跟踪一下代码执行的过程。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802532.png" alt="image-20210728000838992"> </p>
<p>对于前端的代码, 也可以进行debug调试。</p>
<p>F12打开浏览器的调试工具, 找到我们前面提到的request.js, 在request.js的响应拦截器位置打上断点。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802020.png" alt="image-20210728001929657"> </p>
<h2 id="2-新增员工"><a href="#2-新增员工" class="headerlink" title="2. 新增员工"></a>2. 新增员工</h2><h3 id="2-1-需求分析"><a href="#2-1-需求分析" class="headerlink" title="2.1 需求分析"></a>2.1 需求分析</h3><p>后台系统中可以管理员工信息，通过新增员工来添加后台系统用户。点击[添加员工]按钮跳转到新增页面，如下：</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802444.png" alt="image-20210728002442334" style="zoom:80%;" /> 

<p>当填写完表单信息, 点击”保存”按钮后, 会提交该表单的数据到服务端, 在服务端中需要接受数据, 然后将数据保存至数据库中。</p>
<h3 id="2-2-数据模型"><a href="#2-2-数据模型" class="headerlink" title="2.2 数据模型"></a>2.2 数据模型</h3><p>新增员工，其实就是将我们新增页面录入的员工数据插入到employee表。employee表中的status字段已经设置了默认值1，表示状态正常。</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802948.png" alt="image-20210728004144521" style="zoom:80%;" /> 



<p>需要注意，employee表中对username字段加入了唯一约束，因为username是员工的登录账号，必须是唯一的。</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802115.png" alt="image-20210728004250254" style="zoom:80%;" /> 





<h3 id="2-3-程序执行流程"><a href="#2-3-程序执行流程" class="headerlink" title="2.3 程序执行流程"></a>2.3 程序执行流程</h3><p>在开发代码之前，我们需要结合着前端页面发起的请求， 梳理一下整个程序的执行过程：</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021802403.png" alt="image-20210728005638224" style="zoom:80%;" /> 



<p>A. 点击”保存”按钮, 页面发送ajax请求，将新增员工页面中输入的数据以json的形式提交到服务端, 请求方式POST, 请求路径 &#x2F;employee</p>
<p>B. 服务端Controller接收页面提交的数据并调用Service将数据进行保存</p>
<p>C. Service调用Mapper操作数据库，保存数据</p>
<h3 id="2-4-代码实现"><a href="#2-4-代码实现" class="headerlink" title="2.4 代码实现"></a>2.4 代码实现</h3><p>在EmployeeController中增加save方法, 用于保存用户员工信息。</p>
<p>A. 在新增员工时， 按钮页面原型中的需求描述， 需要给员工设置初始默认密码 123456， 并对密码进行MD5加密。</p>
<p>B. 在组装员工信息时, 还需要封装创建时间、修改时间，创建人、修改人信息(从session中获取当前登录用户)。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*新增员工*/</span><br><span class="line">     @PostMapping</span><br><span class="line">    public R&lt;String&gt; save(@RequestBody Employee employee)&#123;</span><br><span class="line">         log.info(&quot;新增员工，员工信息：&#123;&#125;&quot;,employee.toString());</span><br><span class="line">        return  null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>保证前端页面发送的请求  能够请求到save方法  并且提交的参数能够提交到 employee对象上  </p>
<p>@RequestBody：用来获取客户端（前端 ）提交上来的JSON字符串    并将ISON字符串转换成javabeen实体类</p>
<p>@RespomseBody：javabeen实体类转换为JSON</p>
<p> Employee：使用 Employee对象接收前端传递的请求参数（JSON格式）</p>
<p>R：返回值</p>
<p>总体解释1</p>
<p>这段代码是一个使用Spring框架的控制器方法，用于处理HTTP POST请求，并将请求主体中的数据映射为Employee对象来新增员工。</p>
<p>让我们逐行解释代码：</p>
<ul>
<li><code>@PostMapping</code>：这是一个注解，用于将该方法映射到HTTP的POST请求方法。它表示这个方法将处理来自客户端的POST请求。</li>
<li><code>public R&lt;String&gt; save(@RequestBody Employee employee)</code>：这是方法的声明。它接收一个<code>Employee</code>类型的参数，该参数将从请求主体中提取。<code>@RequestBody</code>注解告诉Spring框架从请求主体中获取JSON数据，并将其转换为<code>Employee</code>对象。</li>
<li><code>log.info(&quot;新增员工，员工信息：&#123;&#125;&quot;, employee.toString())</code>：这行代码使用日志记录了新增员工的操作。<code>log.info()</code>方法用于打印信息，并使用占位符<code>&#123;&#125;</code>将<code>employee.toString()</code>的返回值插入到日志信息中。这样可以在控制台或日志文件中查看新增员工的详细信息。</li>
<li><code>return null</code>：这个方法返回一个<code>null</code>值。你可以根据实际需求来返回适当的响应，比如返回一个成功的消息或新员工的ID。</li>
</ul>
<p>所以，当你发送一个HTTP POST请求到这个控制器的URL时，请求主体中的数据将被映射为<code>Employee</code>对象，并在日志中打印出员工的信息。然后，方法将返回一个<code>null</code>值作为响应。你可以根据需求修改方法体，执行适当的业务逻辑或返回相应的结果。</p>
<p>总体解释2</p>
<p>这段代码是一个基于SpringBoot框架搭建的员工管理系统的新增员工功能的接口。</p>
<p>其中，@PostMapping注解表示该接口只接受POST请求。@RequestBody注解表示将请求体中的JSON格式数据绑定到Employee对象上。Employee对象代表了一个员工信息，包括员工ID、姓名、性别、职位等属性。当接收到客户端传来的POST请求时，SpringBoot会自动将请求体中的JSON格式数据转换成对应的Employee对象，并赋值给方法参数employee。</p>
<p>在方法内部，使用log.info打印出新增的员工信息。最后，接口返回的类型为R<String>，代表了一个自定义的响应类，其中R表示响应结果，而String则表示响应消息内容。在这个示例中，接口返回了null。需要根据实际业务需求将null替换成相应的响应结果。</p>
<p>总之，这段代码的主要作用是接收客户端提交的员工信息并写入数据库，同时记录日志并返回响应结果。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131534677.png" alt="image-20230605105616707"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306051054661.png" alt="image-20230605105432572"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131534173.png" alt="image-20230605105816824"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131534469.png" alt="image-20230605105845333"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增员工</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">save</span><span class="params">(HttpServletRequest request,<span class="meta">@RequestBody</span> Employee employee)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;新增员工，员工信息：&#123;&#125;&quot;</span>,employee.toString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置初始密码123456，需要进行md5加密处理</span></span><br><span class="line">    employee.setPassword(DigestUtils.md5DigestAsHex(<span class="string">&quot;123456&quot;</span>.getBytes()));</span><br><span class="line">	</span><br><span class="line">    employee.setCreateTime(LocalDateTime.now());</span><br><span class="line">    employee.setUpdateTime(LocalDateTime.now());</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//获得当前登录用户的id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">empId</span> <span class="operator">=</span> (Long) request.getSession().getAttribute(<span class="string">&quot;employee&quot;</span>);</span><br><span class="line"></span><br><span class="line">    employee.setCreateUser(empId);</span><br><span class="line">    employee.setUpdateUser(empId);</span><br><span class="line"></span><br><span class="line">    employeeService.save(employee);</span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;新增员工成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码解释1</p>
<p>这段代码是一个使用Spring框架的控制器方法，用于处理HTTP POST请求并新增员工。</p>
<p>让我们逐行解释代码：</p>
<ul>
<li><code>@PostMapping</code>：这是一个注解，将该方法映射到HTTP的POST请求方法。</li>
<li><code>public R&lt;String&gt; save(HttpServletRequest request, @RequestBody Employee employee)</code>：这是方法的声明。它接收两个参数：<code>HttpServletRequest request</code>和<code>Employee employee</code>。<code>@RequestBody</code>注解告诉Spring框架从请求主体中获取数据，并将其转换为<code>Employee</code>对象。<code>HttpServletRequest</code>参数用于获取当前请求的相关信息。</li>
<li><code>log.info(&quot;新增员工，员工信息：&#123;&#125;&quot;, employee.toString())</code>：这行代码使用日志记录了新增员工的操作。员工信息通过<code>employee.toString()</code>转换为字符串，并插入到日志信息中。</li>
<li><code>employee.setPassword(DigestUtils.md5DigestAsHex(&quot;123456&quot;.getBytes()))</code>：这行代码设置员工的初始密码为”123456”，并使用MD5加密处理。<code>DigestUtils.md5DigestAsHex()</code>方法将字节数组转换为MD5散列字符串。</li>
<li><code>employee.setCreateTime(LocalDateTime.now())</code>：这行代码将当前时间设置为员工的创建时间。</li>
<li><code>employee.setUpdateTime(LocalDateTime.now())</code>：这行代码将当前时间设置为员工的更新时间。</li>
<li><code>Long empId = (Long) request.getSession().getAttribute(&quot;employee&quot;)</code>：这行代码从当前会话中获取名为”employee”的属性，它表示当前登录用户的ID。</li>
<li><code>employee.setCreateUser(empId)</code>和<code>employee.setUpdateUser(empId)</code>：这两行代码将当前登录用户的ID设置为员工的创建用户和更新用户。</li>
<li><code>employeeService.save(employee)</code>：这行代码调用<code>employeeService</code>服务的<code>save()</code>方法来保存新增的员工信息。</li>
<li><code>return R.success(&quot;新增员工成功&quot;)</code>：这行代码返回一个成功的响应，包含一条”新增员工成功”的消息。</li>
</ul>
<p>总结起来，这段代码处理了一个HTTP POST请求，将请求主体中的数据映射为<code>Employee</code>对象，并对该对象进行一系列处理，如设置初始密码、设置创建时间和更新时间、设置创建用户和更新用户等。最后，调用<code>employeeService</code>的<code>save()</code>方法来保存员工信息，并返回成功的响应消息。</p>
<p>代码解释2</p>
<p>这段代码是一个基于SpringBoot框架搭建的员工管理系统的新增员工功能的接口，相对于之前的代码增加了一些业务逻辑的处理。</p>
<p>其中，@PostMapping注解表示该接口只接受POST请求。@RequestBody注解表示将请求体中的JSON格式数据绑定到Employee对象上。HttpServletRequest request代表HTTP请求信息。Employee对象代表了一个员工信息，包括员工ID、姓名、性别、职位等属性。</p>
<p>在方法内部，使用log.info打印出新增的员工信息。接下来对员工对象进行了一些预处理操作：</p>
<ol>
<li>设置初始密码123456，并通过MD5加密后存入employee对象中；</li>
<li>获取当前时间，并分别设置为创建时间和更新时间；</li>
<li>从session中获取当前登录用户的id，并将其设置为创建用户和更新用户；</li>
</ol>
<p>最后，调用employeeService.save()方法将员工信息写入数据库中，并在接口返回时返回一个自定义的响应类R，其中success表示成功的状态，”新增员工成功”表示响应消息的内容。</p>
<p>总之，这段代码的主要作用是接收客户端提交的员工信息并写入数据库，并进行了一些预处理操作。同时记录日志并返回响应结果。</p>
<p>测试新增员工</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131535557.png" alt="image-20230605112657055"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131535317.png" alt="image-20230605112841758"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131535845.png" alt="image-20230605112910313"></p>
<p>如果在录入一个zhagsan   就会出现问题</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131535685.png" alt="image-20230605113633322"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131535269.png" alt="image-20230605113648946"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131535422.png" alt="image-20230605113727456"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306052104630.png" alt="image-20230605210446510"></p>
<h3 id="2-5-功能测试"><a href="#2-5-功能测试" class="headerlink" title="2.5 功能测试"></a>2.5 功能测试</h3><p>代码编写完毕之后，我们需要将工程重启, 完毕之后直接访问管理系统首页, 点击 “员工管理” 页面中的 “添加员工” 按钮, 输入员工基本信息, 然后点击 “保存” 进行数据保存, 保存完毕后, 检查数据库中是否录入员工数据。</p>
<p>当我们在测试中，添加用户时， 输入了一个已存在的用户名时，前端界面出现错误提示信息： </p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021803107.png" alt="image-20210728010841569" style="zoom:80%;" /> 

<p>而此时，服务端已经报错了， 报错信息如下： </p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021803771.png" alt="image-20210728010938086"> </p>
<p>出现上述的错误， 主要就是因为在 employee 表结构中，我们针对于username字段，建立了唯一索引，添加重复的username数据时，违背该约束，就会报错。但是此时前端提示的信息并不具体，用户并不知道是因为什么原因造成的该异常，我们需要给用户提示详细的错误信息 。</p>
<h3 id="2-6-全局异常处理"><a href="#2-6-全局异常处理" class="headerlink" title="2.6 全局异常处理"></a>2.6 全局异常处理</h3><h4 id="2-6-1-思路分析"><a href="#2-6-1-思路分析" class="headerlink" title="2.6.1 思路分析"></a>2.6.1 思路分析</h4><p>要想解决上述测试中存在的问题，我们需要对程序中可能出现的异常进行捕获，通常有两种处理方式：</p>
<p><strong>A. 在Controller方法中加入 try…catch 进行异常捕获</strong></p>
<p>形式如下： </p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021803763.png" alt="image-20210729094125294" style="zoom:80%;" /> 

<p>如果采用这种方式，虽然可以解决，但是存在弊端，需要我们在保存其他业务数据时，也需要在Controller方法中加上try…catch进行处理，代码冗余，不通用。</p>
<p><strong>B. 使用异常处理器进行全局异常捕获</strong></p>
<p>采用这种方式来实现，我们只需要在项目中定义一个通用的全局异常处理器，就可以解决本项目的所有异常。</p>
<h4 id="2-6-2-全局异常处理器"><a href="#2-6-2-全局异常处理器" class="headerlink" title="2.6.2 全局异常处理器"></a>2.6.2 全局异常处理器</h4><p>在项目中自定义一个全局异常处理器，在异常处理器上加上注解 @ControllerAdvice,可以通过属性annotations指定拦截哪一类的Controller方法。 并在异常处理器的方法上加上注解 @ExceptionHandler 来指定拦截的是那一类型的异常。</p>
<blockquote>
<p>异常处理方法逻辑: </p>
<ul>
<li>指定捕获的异常类型为 SQLIntegrityConstraintViolationException</li>
<li>解析异常的提示信息, 获取出是那个值违背了唯一约束 </li>
<li>组装错误信息并返回</li>
</ul>
</blockquote>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021803259.png" alt="image-20210729100232642" style="zoom:80%;" /> 





<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 全局异常处理</span><br><span class="line"> */</span><br><span class="line">@ControllerAdvice(annotations = &#123;RestController.class, Controller.class&#125;)</span><br><span class="line">@ResponseBody</span><br><span class="line">@Slf4j</span><br><span class="line">public class GlobalExceptionHandler &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 异常处理方法</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @ExceptionHandler(SQLIntegrityConstraintViolationException.class)</span><br><span class="line">    public R&lt;String&gt; exceptionHandler(SQLIntegrityConstraintViolationException ex)&#123;</span><br><span class="line">        log.error(ex.getMessage());</span><br><span class="line">         return R.error(&quot;失败了&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码解释1：</p>
<p>以上代码是一个用于全局异常处理的类。该类使用了Spring的@ControllerAdvice注解来标识它是一个全局异常处理器。通过该注解，它会拦截被@RestController和@Controller注解标注的类中发生的异常。</p>
<p>具体解释如下：</p>
<ol>
<li><code>@ControllerAdvice(annotations = &#123;RestController.class, Controller.class&#125;)</code>：这是一个类级别的注解，用于指定该全局异常处理类要拦截的Controller类的注解类型。在这里，它指定要拦截的类必须是标注了@RestController或@Controller注解的类。</li>
<li><code>@ResponseBody</code>：这是一个方法级别的注解，表示该方法的返回值将直接作为响应的内容返回给客户端，而不是被视图解析器解析为视图。在这里，它确保异常处理方法的返回值将被转换为响应的JSON格式。</li>
<li><code>@ExceptionHandler(SQLIntegrityConstraintViolationException.class)</code>：这是一个方法级别的注解，用于指定该方法要处理的特定异常类型。在这里，它指定该方法要处理的异常是SQLIntegrityConstraintViolationException。</li>
<li><code>public R&lt;String&gt; exceptionHandler(SQLIntegrityConstraintViolationException ex)</code>：这是异常处理方法，它接收一个SQLIntegrityConstraintViolationException类型的参数，表示捕获到的异常对象。方法的返回类型为R<String>，R是一个自定义的通用响应对象，用于包装响应数据。</li>
<li><code>log.error(ex.getMessage())</code>：这行代码使用Slf4j提供的日志记录功能，将异常的错误消息记录到日志中。</li>
<li><code>return R.error(&quot;失败了&quot;)</code>：这行代码返回一个R对象，表示处理异常后的响应结果。使用R.error静态方法创建一个错误类型的R对象，并设置错误消息为”失败了”。</li>
</ol>
<p>综上所述，以上代码定义了一个全局异常处理类，用于捕获和处理Controller层中发生的SQLIntegrityConstraintViolationException异常，并将错误信息记录到日志中，最后返回一个错误类型的响应结果。</p>
<p>代码解释2</p>
<p>这段代码是一个基于SpringBoot框架的全局异常处理类，用于捕获并处理SQL异常。</p>
<p>@ControllerAdvice注解表示该类用于全局异常处理。通过annotations参数指定了需要拦截的控制器注解类型为@RestController和@Controller。@ResponseBody注解表示返回的是JSON格式的数据。@Slf4j注解表示使用log记录日志。</p>
<p>@ExceptionHandler注解表示该方法用于捕获SQLIntegrityConstraintViolationException类型的异常。当系统出现SQLIntegrityConstraintViolationException类型的异常时，会调用该方法进行异常处理。在方法内部，使用log.error打印异常信息，并返回一个自定义的响应类R，其中error表示失败的状态，”失败了”表示响应消息的内容。</p>
<p>总之，这段代码的主要作用是实现对SQLIntegrityConstraintViolationException类型异常的统一捕获和处理。当系统出现该类型的异常时，会执行该方法进行异常处理，并记录日志并返回响应结果。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131536381.png" alt="image-20230605205207722"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131536773.png" alt="image-20230605213011631"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131536460.png" alt="image-20230605213021868"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131536813.png" alt="image-20230605213228144"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131536013.png" alt="image-20230605213259694"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131536837.png" alt="image-20230605213319536"></p>
<p>所属包: com.itheima.reggie.common</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLIntegrityConstraintViolationException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 全局异常处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ControllerAdvice(annotations = &#123;RestController.class, Controller.class&#125;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span>  <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 异常处理方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(SQLIntegrityConstraintViolationException.class)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;String&gt; <span class="title function_">exceptionHandler</span><span class="params">(SQLIntegrityConstraintViolationException ex)</span>&#123;</span><br><span class="line">        log.error(ex.getMessage());</span><br><span class="line">        <span class="keyword">if</span>(ex.getMessage().contains(<span class="string">&quot;Duplicate entry&quot;</span>))&#123;</span><br><span class="line">            String[] split = ex.getMessage().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> split[<span class="number">2</span>] + <span class="string">&quot;已存在&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> R.error(msg);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R.error(<span class="string">&quot;未知错误&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><font color='red'><b>注解说明:</b></font></p>
<p>​	上述的全局异常处理器上使用了的两个注解 @ControllerAdvice , @ResponseBody , 他们的作用分别为: </p>
<p>​	@ControllerAdvice : 指定拦截那些类型的控制器;</p>
<p>​	@ResponseBody: 将方法的返回值 R 对象转换为json格式的数据, 响应给页面;</p>
<p>​	</p>
<p>​	上述使用的两个注解, 也可以合并成为一个注解 @RestControllerAdvice </p>
<p>​	<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021803411.png" alt="image-20210729100052940" style="zoom:80%;" /> </p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537148.png" alt="image-20230605214040718"></p>
<p>代码解释1</p>
<p>以上代码是一个 Java 类，它包含了一个名为<code>GlobalExceptionHandler</code>的异常处理类。该类包含了一个名为<code>exceptionHandler</code>的方法，该方法接收一个<code>SQLIntegrityConstraintViolationException</code>类型的异常作为参数。</p>
<p>在<code>exceptionHandler</code>方法中，首先使用<code>log.error(ex.getMessage())</code>方法将异常消息保存到日志中。然后，使用<code>ex.getMessage()</code>方法获取异常消息，并将其分成多个字符串，以便进一步处理。</p>
<p>如果异常消息中包含字符串<code>&quot;Duplicate entry&quot;</code>,则方法将使用<code>split()</code>方法将字符串分成多个字符串，然后从中获取第 3 个字符串，该字符串通常是描述存在重复项的详细信息。最后，方法将使用<code>error()</code>方法将详细信息转换为<code>R&lt;String&gt;</code>类型的响应，并返回该响应。如果异常消息中包含其他字符串，则方法将返回<code>R.error(&quot;未知错误&quot;)</code>类型的响应。</p>
<p>需要注意的是，该代码中的<code>@ExceptionHandler</code>注解用于指定处理的异常类型，并返回<code>R&lt;String&gt;</code>类型的数据。该注解需要与<code>@RestController</code>注解一起使用，以便将异常处理与 RESTful API 集成。</p>
<p>在详细解释</p>
<p>以上代码中的<code>@ExceptionHandler</code>注解是一个异常处理注解，它用于指定处理哪种类型的异常。在此示例中，<code>@ExceptionHandler(SQLIntegrityConstraintViolationException.class)</code>指定了该方法处理<code>SQLIntegrityConstraintViolationException</code>类型的异常。</p>
<p><code>@ExceptionHandler</code>注解有一个参数，即要处理的异常类型。在此示例中，<code>SQLIntegrityConstraintViolationException</code>是我们要处理的异常类型。当程序遇到这种异常时，它将被传递给<code>exceptionHandler</code>方法进行处理。</p>
<p><code>exceptionHandler</code>方法是一个返回值方法，它接收一个<code>SQLIntegrityConstraintViolationException</code>类型的异常作为参数。在方法内部，我们首先使用<code>log.error(ex.getMessage())</code>方法将异常消息保存到日志中。然后，我们使用<code>ex.getMessage()</code>方法获取异常消息，并将其分成多个字符串。</p>
<p>如果异常消息中包含字符串<code>&quot;Duplicate entry&quot;</code>,则方法将使用<code>split()</code>方法将字符串分成多个字符串，然后从中获取第 3 个字符串，该字符串通常是描述存在重复项的详细信息。在此示例中，我们将第 3 个字符串作为参数传递给<code>error()</code>方法，以将详细信息转换为<code>R&lt;String&gt;</code>类型的响应。如果异常消息中包含其他字符串，则方法将返回<code>R.error(&quot;未知错误&quot;)</code>类型的响应。</p>
<p>最后，我们需要将异常处理与 RESTful API 集成。在此示例中，<code>@RestController</code>注解指定了该控制器处理 RESTful API 请求。因此，当程序遇到异常时，它将被传递给 RESTful API 控制器中的异常处理函数。在这种情况下，该函数使用<code>@ExceptionHandler</code>注解指定要处理的异常类型，并返回一个错误响应。</p>
<p>代码解释2</p>
<p>以上代码是一个全局异常处理器，用于捕获在@RestController 或 @Controller标注的控制器中抛出的异常，并返回统一格式的错误信息。</p>
<p>其中，@ControllerAdvice 注解表示该类是一个全局异常处理器，@ResponseBody 注解表示返回结果是一个 JSON 格式的数据，@Slf4j 则是一个Slf4j日志工具，常用于输出日志信息。</p>
<p>在代码实现方面，@ExceptionHandler 注解用于指定处理的异常类型，并返回 R<String> 类型的数据。</p>
<p>这段代码的处理流程是：当捕获到 SQLIntegrityConstraintViolationException 异常时，如果异常信息中包含”Duplicate entry”字样，则认为是数据重复的异常，从异常信息中提取出具体的数据，然后返回一个包含该信息的 R 类型的数据；否则，返回一个”未知错误”的 R 类型的数据。 </p>
<p>代码解释3</p>
<p>以上代码是一个全局异常处理类，使用了Spring框架提供的@ControllerAdvice注解。该类用于捕获和处理控制器中抛出的异常。</p>
<p>代码中的注解<code>@ControllerAdvice(annotations = &#123;RestController.class, Controller.class&#125;)</code>表示该类只会处理带有<code>@RestController</code>或<code>@Controller</code>注解的控制器中发生的异常。</p>
<p>注解<code>@ResponseBody</code>表示该类的方法返回的结果将直接作为响应体返回，而不是被视图解析器解析为视图。就是将javabeen转换成JSON返回</p>
<p><code>@Slf4j</code>是一个Lombok注解，用于自动生成日志记录器。</p>
<p><code>@ExceptionHandler(SQLIntegrityConstraintViolationException.class)</code>表示该方法将处理<code>SQLIntegrityConstraintViolationException</code>类型的异常。在方法中，它首先记录了异常的错误消息，然后检查错误消息中是否包含”Duplicate entry”，如果包含，则根据错误消息中的内容生成相应的错误信息并返回一个<code>R</code>对象（可能是自定义的响应对象）。</p>
<p>如果错误消息不包含”Duplicate entry”，则返回一个包含默认错误信息的<code>R</code>对象。</p>
<p>值得注意的是，代码中的<code>返回 R.error(msg);</code>这行代码是伪代码，实际上应该返回一个<code>R</code>对象。在这个例子中，<code>R.error(msg)</code>是一个伪代码，意思是返回一个带有错误信息<code>msg</code>的<code>R</code>对象。具体的<code>R</code>对象实现和使用方式需要根据实际情况进行定义和处理。</p>
<p>总结：以上代码是一个全局异常处理类，用于捕获和处理控制器中抛出的<code>SQLIntegrityConstraintViolationException</code>异常。根据异常的错误消息，它生成相应的错误信息并返回一个<code>R</code>对象（伪代码），用于表示异常处理结果。</p>
<p>在详细一点解释</p>
<p>当在使用Spring框架进行开发时，我们经常需要处理控制器中可能抛出的异常，以提供更好的错误处理和友好的错误响应。全局异常处理类就是用于这个目的。</p>
<p>首先，我们可以使用<code>@ControllerAdvice</code>注解来标识一个类作为全局异常处理类。在本例中，该注解使用了<code>annotations</code>属性，指定了需要处理的控制器注解类型为<code>@RestController</code>和<code>@Controller</code>。</p>
<p>接下来，使用<code>@ExceptionHandler</code>注解来标识一个方法作为异常处理方法。在本例中，该方法处理的是<code>SQLIntegrityConstraintViolationException</code>类型的异常。</p>
<p>在异常处理方法中，我们首先使用<code>@Slf4j</code>注解生成一个日志记录器，以便记录异常的错误消息。</p>
<p>接下来，我们检查异常的错误消息是否包含”Duplicate entry”，即是否是因为违反了唯一性约束（Duplicate entry）而抛出的异常。如果是，我们从错误消息中提取出相应的信息，并根据该信息生成一个新的错误消息。</p>
<p>在这个例子中，我们使用了<code>ex.getMessage().contains(&quot;Duplicate entry&quot;)</code>来检查错误消息是否包含”Duplicate entry”，然后使用<code>ex.getMessage().split(&quot; &quot;)</code>来将错误消息按空格分割，获取了相关信息。</p>
<p>生成新的错误消息后，我们使用<code>R.error(msg)</code>来创建一个响应对象，其中<code>msg</code>是错误消息。这里的<code>R.error()</code>是一个伪代码，表示返回一个带有错误信息的响应对象。</p>
<p>如果错误消息不包含”Duplicate entry”，则说明是其他未知错误，我们返回一个默认的错误响应对象，其中包含一个表示未知错误的默认错误信息。</p>
<p>需要注意的是，代码中的<code>返回 R.error(msg);</code>这行代码是伪代码，实际上应该返回一个<code>R</code>对象，具体的返回方式需要根据实际情况进行定义和处理。</p>
<p>通过使用这个全局异常处理类，我们可以集中处理控制器中抛出的指定类型的异常，并提供自定义的错误响应。这样可以简化代码逻辑，并提供统一的异常处理机制，提升系统的健壮性和用户体验。</p>
<p>当我们新增一个已经存在的值的时候</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537709.png" alt="image-20230605220243398"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537244.png" alt="image-20230605220305991"></p>
<p>当我们新增不存在的值的时候</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537429.png" alt="image-20230605220456101"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537941.png" alt="image-20230605220507912"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537973.png" alt="image-20230605220526780"></p>
<h4 id="2-6-3-测试"><a href="#2-6-3-测试" class="headerlink" title="2.6.3 测试"></a>2.6.3 测试</h4><p>全局异常处理器编写完毕之后，我们需要将项目重启, 完毕之后直接访问管理系统首页, 点击 “员工管理” 页面中的 “添加员工” 按钮。当我们在测试中，添加用户时， 输入了一个已存在的用户名时，前端界面出现如下错误提示信息：</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131537615.png" alt="image-20210729102220135" style="zoom:80%;" /> 





<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131538397.png" alt="image-20230605220945408"></p>
<h2 id="3-员工分页查询"><a href="#3-员工分页查询" class="headerlink" title="3. 员工分页查询"></a>3. 员工分页查询</h2><h3 id="3-1-需求分析"><a href="#3-1-需求分析" class="headerlink" title="3.1 需求分析"></a>3.1 需求分析</h3><p>系统中的员工很多的时候，如果在一个页面中全部展示出来会显得比较乱，不便于查看，所以一般的系统中都会以分页的方式来展示列表数据。而在我们的分页查询页面中, 除了分页条件以外，还有一个查询条件     比如查询”员工姓名”。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021803131.png" alt="image-20210729134904625"> </p>
<ul>
<li><p>请求参数</p>
<ul>
<li><p>搜索条件： 员工姓名(模糊查询)</p>
</li>
<li><p>分页条件： 每页展示条数 ， 页码</p>
</li>
</ul>
</li>
<li><p>响应数据</p>
<ul>
<li>总记录数</li>
</ul>
</li>
<li><p>结果列表</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131538518.png" alt="image-20230605221457990"></p>
<p>1). 页面发送ajax请求，将分页查询参数(page、pageSize、name)提交到服务端</p>
<p>F12   刷新页面</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131538525.png" alt="image-20230605221857857"></p>
<p><img src="C:\Users\zyz\AppData\Roaming\Typora\typora-user-images\image-20230605221909418.png" alt="image-20230605221909418"></p>
<p>page&#x3D;1&amp;pageSize&#x3D;10   查第一页  一共查10条数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131538788.png" alt="image-20230605222104747"></p>
<p>看前端代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131538718.png" alt="image-20230605222232623"></p>
<p>为什么一加载 就会把请求发出去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">     new Vue(&#123;</span><br><span class="line">       el: &#x27;#member-app&#x27;,</span><br><span class="line">       data() &#123;</span><br><span class="line">         return &#123;</span><br><span class="line">            input: &#x27;&#x27;,</span><br><span class="line">            counts: 0,</span><br><span class="line">            page: 1,</span><br><span class="line">            pageSize: 2,</span><br><span class="line">            tableData : [],</span><br><span class="line">            id : &#x27;&#x27;,</span><br><span class="line">            status : &#x27;&#x27;,</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;,</span><br><span class="line">       computed: &#123;&#125;,</span><br><span class="line">       created() &#123;</span><br><span class="line">         this.init()</span><br><span class="line">           if(localStorage.getItem(&#x27;userInfo&#x27;) != null)&#123;</span><br><span class="line">               //获取当前登录员工的账号，并赋值给模型数据user</span><br><span class="line">               this.user = JSON.parse(localStorage.getItem(&#x27;userInfo&#x27;)).username</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;,</span><br><span class="line">       mounted() &#123;</span><br><span class="line">       &#125;,</span><br><span class="line">       methods: &#123;</span><br><span class="line">         async init () &#123;</span><br><span class="line">           const params = &#123;</span><br><span class="line">             page: this.page,</span><br><span class="line">             pageSize: this.pageSize,</span><br><span class="line">             name: this.input ? this.input : undefined</span><br><span class="line">           &#125;</span><br><span class="line">           await getMemberList(params).then(res =&gt; &#123;</span><br><span class="line">             if (String(res.code) === &#x27;1&#x27;) &#123;</span><br><span class="line">               this.tableData = res.data.records || []</span><br><span class="line">               this.counts = res.data.total</span><br><span class="line">             &#125;</span><br><span class="line">           &#125;).catch(err =&gt; &#123;</span><br><span class="line">             this.$message.error(&#x27;请求出错了：&#x27; + err)</span><br><span class="line">           &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         handleQuery() &#123;</span><br><span class="line">           this.page = 1;</span><br><span class="line">           this.init();</span><br><span class="line">         &#125;,</span><br><span class="line">          // 添加</span><br><span class="line">         addMemberHandle (st) &#123;</span><br><span class="line">           if (st === &#x27;add&#x27;)&#123;</span><br><span class="line">             window.parent.menuHandle(&#123;</span><br><span class="line">               id: &#x27;2&#x27;,</span><br><span class="line">               url: &#x27;/backend/page/member/add.html&#x27;,</span><br><span class="line">               name: &#x27;添加员工&#x27;</span><br><span class="line">             &#125;,true)</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">             window.parent.menuHandle(&#123;</span><br><span class="line">               id: &#x27;2&#x27;,</span><br><span class="line">               url: &#x27;/backend/page/member/add.html?id=&#x27;+st,</span><br><span class="line">               name: &#x27;修改员工&#x27;</span><br><span class="line">             &#125;,true)</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         //状态修改</span><br><span class="line">         statusHandle (row) &#123;</span><br><span class="line">           this.id = row.id</span><br><span class="line">           this.status = row.status</span><br><span class="line">           this.$confirm(&#x27;确认调整该账号的状态?&#x27;, &#x27;提示&#x27;, &#123;</span><br><span class="line">             &#x27;confirmButtonText&#x27;: &#x27;确定&#x27;,</span><br><span class="line">             &#x27;cancelButtonText&#x27;: &#x27;取消&#x27;,</span><br><span class="line">             &#x27;type&#x27;: &#x27;warning&#x27;</span><br><span class="line">             &#125;).then(() =&gt; &#123;</span><br><span class="line">             enableOrDisableEmployee(&#123; &#x27;id&#x27;: this.id, &#x27;status&#x27;: !this.status ? 1 : 0 &#125;).then(res =&gt; &#123;</span><br><span class="line">               console.log(&#x27;enableOrDisableEmployee&#x27;,res)</span><br><span class="line">               if (String(res.code) === &#x27;1&#x27;) &#123;</span><br><span class="line">                 this.$message.success(&#x27;账号状态更改成功！&#x27;)</span><br><span class="line">                 this.handleQuery()</span><br><span class="line">               &#125;</span><br><span class="line">             &#125;).catch(err =&gt; &#123;</span><br><span class="line">               this.$message.error(&#x27;请求出错了：&#x27; + err)</span><br><span class="line">             &#125;)</span><br><span class="line">           &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         handleSizeChange (val) &#123;</span><br><span class="line">           this.pageSize = val</span><br><span class="line">           this.init()</span><br><span class="line">         &#125;,</span><br><span class="line">         handleCurrentChange (val) &#123;</span><br><span class="line">           this.page = val</span><br><span class="line">           this.init()</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;)</span><br><span class="line">   &lt;/script&gt;</span><br></pre></td></tr></table></figure>



<p>以上代码是一个使用Vue框架编写的前端页面脚本。它创建了一个Vue实例，其中包含了一些数据和方法。</p>
<p>首先，在Vue实例的<code>data</code>属性中定义了一些数据，包括<code>input</code>（输入框的值），<code>counts</code>（数据总数），<code>page</code>（当前页码），<code>pageSize</code>（每页显示的数据量），<code>tableData</code>（表格数据），<code>id</code>（员工ID），<code>status</code>（员工状态）等。</p>
<p>在<code>created</code>生命周期钩子函数中，通过读取浏览器本地存储（localStorage）中的<code>userInfo</code>，将当前登录员工的账号赋值给<code>user</code>数据。</p>
<p>在<code>mounted</code>生命周期钩子函数中，可以执行一些页面加载后需要进行的操作，但在这个代码片段中没有具体的逻辑。</p>
<p>接下来是一些方法的定义：</p>
<ol>
<li><code>init</code>方法：该方法用于初始化页面数据，它通过调用<code>getMemberList</code>函数获取员工列表数据，并将返回的数据赋值给<code>tableData</code>和<code>counts</code>。</li>
<li><code>handleQuery</code>方法：当用户点击查询按钮时，将页码（<code>page</code>）重置为1，然后调用<code>init</code>方法重新加载数据。</li>
<li><code>addMemberHandle</code>方法：用于处理添加员工或修改员工的操作。根据传入的参数<code>st</code>（可以是’add’或员工ID），通过调用<code>window.parent.menuHandle</code>方法打开相应的页面进行添加或修改员工操作。</li>
<li><code>statusHandle</code>方法：用于处理账号状态的更改。首先将员工的ID和状态赋值给<code>id</code>和<code>status</code>，然后弹出确认对话框，确认调整账号状态后，调用<code>enableOrDisableEmployee</code>函数发送请求，将员工的状态进行更改。如果请求成功，则显示成功提示信息，并调用<code>handleQuery</code>方法重新加载数据。</li>
<li><code>handleSizeChange</code>方法：当用户改变每页显示数据量时，将新的数据量赋值给<code>pageSize</code>，然后调用<code>init</code>方法重新加载数据。</li>
<li><code>handleCurrentChange</code>方法：当用户改变当前页码时，将新的页码赋值给<code>page</code>，然后调用<code>init</code>方法重新加载数据。</li>
</ol>
<p>综上所述，以上代码主要实现了一个员工管理的前端页面，包括员工列表的展示、查询、添加、修改和账号状态的更改等功能。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getMemberList (params) &#123;</span><br><span class="line">  return $axios(&#123;</span><br><span class="line">    url: &#x27;/employee/page&#x27;,</span><br><span class="line">    method: &#x27;get&#x27;,</span><br><span class="line">    params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>以上代码定义了一个名为<code>getMemberList</code>的函数，它接受一个名为<code>params</code>的参数。</p>
<p>该函数使用<code>$axios</code>对象（可能是一个封装了Ajax请求的库）发送一个GET请求，请求的URL是<code>/employee/page</code>。请求的参数使用<code>params</code>对象传递，并设置请求的方法为GET。</p>
<p>函数执行后，会返回一个Promise对象，可以通过<code>.then()</code>和<code>.catch()</code>方法处理请求的结果或错误。</p>
<p>简而言之，该函数用于发送一个GET请求到指定URL，参数为<code>params</code>对象中的参数，以获取员工列表的数据。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131538116.png" alt="image-20230605223028153"></p>
<h3 id="3-2-程序执行流程"><a href="#3-2-程序执行流程" class="headerlink" title="3.2 程序执行流程"></a>3.2 程序执行流程</h3><h4 id="3-2-1-页面流程分析"><a href="#3-2-1-页面流程分析" class="headerlink" title="3.2.1 页面流程分析"></a>3.2.1 页面流程分析</h4><p>在开发代码之前，需要梳理一下整个程序的执行过程。</p>
<p>A. 点击菜单，打开员工管理页面时，执行查询： </p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804883.png" alt="image-20210729163400772" style="zoom:80%;" /> 



<p>B. 搜索栏输入员工姓名,回车,执行查询:</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804030.png" alt="image-20210729164259997"> </p>
<p>1). 页面发送ajax请求，将分页查询参数(page、pageSize、name)提交到服务端</p>
<p>2). 服务端Controller接收页面提交的数据, 并组装条件调用Service查询数据</p>
<p>3). Service调用Mapper操作数据库，查询分页数据</p>
<p>4). Controller将查询到的分页数据, 响应给前端页面</p>
<p>5). 页面接收到分页数据, 并通过ElementUI的Table组件展示到页面上</p>
<h4 id="3-2-2-前端代码介绍"><a href="#3-2-2-前端代码介绍" class="headerlink" title="3.2.2 前端代码介绍"></a>3.2.2 前端代码介绍</h4><p>1). 访问员工列表页面&#x2F;member&#x2F;list.html时, 会触发Vuejs中的钩子方法, 在页面初始化时调用created方法</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804771.png" alt="image-20210729231639034" style="zoom:80%;" /> 

<p>从上述的前端代码中我们可以看到, 执行完分页查询, 我们需要给前端返回的信息中需要包含两项 : records 中封装结果列表, total中封装总记录数 。</p>
<p>而在组装请求参数时 , page、pageSize 都是前端分页插件渲染时的参数；</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804003.png" alt="image-20210729232916380" style="zoom:80%;" /> 





<p>2). 在getMemberList方法中, 通过axios发起异步请求</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804595.png" alt="image-20210729231745143"> </p>
<p>axios发起的异步请求会被声明在 request.js 中的request拦截器拦截, 在其中对get请求进行进一步的封装处理</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804051.png" alt="image-20210729232036767"> </p>
<p><strong>最终发送给服务端的请求为 :</strong> GET请求 , 请求链接 &#x2F;employee&#x2F;page?page&#x3D;1&amp;pageSize&#x3D;10&amp;name&#x3D;xxx</p>
<h3 id="3-3-代码实现"><a href="#3-3-代码实现" class="headerlink" title="3.3 代码实现"></a>3.3 代码实现</h3><h4 id="3-3-1-分页插件配置"><a href="#3-3-1-分页插件配置" class="headerlink" title="3.3.1 分页插件配置"></a>3.3.1 分页插件配置</h4><p>当前我们要实现的分页查询功能，而在MybatisPlus要实现分页功能，就需要用到MybatisPlus中提供的分页插件，要使用分页插件，就要在配置类中声明分页插件的bean对象。</p>
<p>所属包: com.itheima.reggie.config</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 配置MP的分页插件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//创建了一个`MybatisPlusInterceptor`对象</span></span><br><span class="line">        <span class="comment">//`MybatisPlusInterceptor`是MyBatis-Plus框架提供的拦截器，可以在执行MyBatis的SQL语句过程中添加额外的功能。</span></span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">mybatisPlusInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">//通过调用`addInnerInterceptor`方法，将一个`PaginationInnerInterceptor`对象作为内部拦截器添加到`MybatisPlusInterceptor`中。`PaginationInnerInterceptor`是MyBatis-Plus提供的分页插件，它能够拦截SQL语句，并根据传入的分页参数自动进行分页查询。</span></span><br><span class="line">        mybatisPlusInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>());</span><br><span class="line">        <span class="keyword">return</span> mybatisPlusInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码解释1</p>
<p>以上代码是一个Java类，用于配置MyBatis-Plus（简称MP）的分页插件。</p>
<ol>
<li><code>@Configuration</code>注解表示这是一个配置类，用于配置应用程序的一些组件或功能。</li>
<li><code>MybatisPlusConfig</code>类中定义了一个名为<code>mybatisPlusInterceptor</code>的Bean方法，用于创建并返回一个<code>MybatisPlusInterceptor</code>对象。</li>
<li><code>MybatisPlusInterceptor</code>是MyBatis-Plus提供的拦截器，用于拦截MyBatis的SQL执行过程，在执行过程中添加额外的功能。通过调用<code>addInnerInterceptor</code>方法，将一个<code>PaginationInnerInterceptor</code>对象添加为<code>MybatisPlusInterceptor</code>的内部拦截器。</li>
<li><code>PaginationInnerInterceptor</code>是MyBatis-Plus提供的分页插件，它可以自动拦截SQL语句，根据传入的分页参数进行分页查询。将<code>PaginationInnerInterceptor</code>添加到<code>MybatisPlusInterceptor</code>中后，可以实现对查询结果进行自动分页。</li>
<li><code>@Bean</code>注解表示将该方法返回的对象注册为一个Spring的Bean，可以在其他组件中通过依赖注入来使用。</li>
</ol>
<p>综上所述，以上代码配置了MyBatis-Plus的分页插件，通过创建<code>MybatisPlusInterceptor</code>对象，并添加<code>PaginationInnerInterceptor</code>作为内部拦截器，实现了对MyBatis的自动分页功能。</p>
<p>详细一点</p>
<p>当使用MyBatis-Plus框架进行数据库操作时，有时需要对查询结果进行分页显示。以上代码展示了如何配置MyBatis-Plus的分页插件。</p>
<p>首先，创建一个Java类，并添加<code>@Configuration</code>注解，表示这是一个配置类。该类的主要目的是配置MyBatis-Plus的分页插件。</p>
<p>在该配置类中，定义了一个名为<code>mybatisPlusInterceptor</code>的方法，并使用<code>@Bean</code>注解进行标记。这意味着该方法返回的对象会被注册为一个Spring的Bean，可以在其他组件中通过依赖注入来使用。</p>
<p>在<code>mybatisPlusInterceptor</code>方法中，创建了一个<code>MybatisPlusInterceptor</code>对象，并进行了配置。<code>MybatisPlusInterceptor</code>是MyBatis-Plus框架提供的拦截器，可以在执行MyBatis的SQL语句过程中添加额外的功能。</p>
<p>通过调用<code>addInnerInterceptor</code>方法，将一个<code>PaginationInnerInterceptor</code>对象作为内部拦截器添加到<code>MybatisPlusInterceptor</code>中。<code>PaginationInnerInterceptor</code>是MyBatis-Plus提供的分页插件，它能够拦截SQL语句，并根据传入的分页参数自动进行分页查询。</p>
<p>这样，通过配置<code>MybatisPlusInterceptor</code>的内部拦截器为<code>PaginationInnerInterceptor</code>，就实现了对MyBatis的自动分页功能。</p>
<p>总结起来，以上代码通过配置MyBatis-Plus的分页插件，使得在使用MyBatis-Plus进行数据库查询时，可以方便地进行分页操作，以便在页面上分批显示查询结果。这样，开发人员无需手动编写分页逻辑，而是让分页插件自动拦截SQL语句，并根据传入的分页参数进行分页查询，简化了开发过程。</p>
<p>代码解释2</p>
<p>这段代码实现了MyBatis Plus分页插件的配置。MyBatis Plus是基于MyBatis的增强工具，在提升开发效率的同时也提供了一些强大的功能，其中之一就是分页插件。</p>
<p>在这段代码中，我们定义了一个MybatisPlusInterceptor实例，并向其中添加了一个PaginationInnerInterceptor内部拦截器，该拦截器就是用于实现分页功能的。最后将该MybatisPlusInterceptor实例作为Bean注册到Spring容器中，完成MyBatis Plus分页插件的配置。</p>
<p>代码解释3</p>
<p>以上代码是一个 MyBatis-Plus 的配置类，它定义了一个名为<code>mybatisPlusInterceptor</code>的 Bean。该 Bean 的作用是在 MyBatis-Plus 中使用 Pagination 插件进行分页处理。</p>
<p>在<code>mybatisPlusInterceptor</code>方法中，我们创建了一个名为<code>MybatisPlusInterceptor</code>的新对象，并将其返回。这个对象是一个拦截器对象，可以在执行 SQL 操作之前或之后进行拦截。在这里，我们添加了一个内部拦截器<code>PaginationInnerInterceptor</code>,以便在执行查询操作时进行分页处理。</p>
<p><code>PaginationInnerInterceptor</code>是一个自定义的内部拦截器，它的作用是在执行查询操作时，将查询语句分成多个部分，并根据需要对每个部分进行分页处理。在这个例子中，我们将每个部分的大小设置为 10，这意味着每个部分的大小为 10 条记录。</p>
<p>在返回<code>MybatisPlusInterceptor</code>对象之后，我们可以在配置文件中定义<code>@Bean</code>方法来创建该对象。在这种情况下，<code>MybatisPlusConfig</code>类是一个配置类，它定义了一个<code>@Bean</code>方法<code>mybatisPlusInterceptor</code>来创建<code>MybatisPlusInterceptor</code>对象。</p>
<p>通过在配置文件中定义<code>@Bean</code>方法来创建<code>MybatisPlusInterceptor</code>对象，我们可以在应用程序启动时自动配置 MyBatis-Plus，以便在执行查询操作时进行分页处理。</p>
<p>详细一点</p>
<p>MyBatis-Plus 是一个开源的持久层框架，它提供了许多功能，例如自动建表、动态 SQL、事务管理等等。其中，分页插件是 MyBatis-Plus 提供的一个重要功能，它可以帮助开发人员更方便地进行分页处理。</p>
<p>以上代码中的 <code>MybatisPlusConfig</code> 类是一个配置类，它定义了一个 <code>@Bean</code> 方法 <code>mybatisPlusInterceptor</code>,用于创建 <code>MybatisPlusInterceptor</code> 对象。这个对象是一个拦截器对象，可以在执行 SQL 操作之前或之后进行拦截。在这里，我们添加了一个内部拦截器 <code>PaginationInnerInterceptor</code>,它的作用是在执行查询操作时，将查询语句分成多个部分，并根据需要对每个部分进行分页处理。</p>
<p><code>PaginationInnerInterceptor</code> 是自定义的内部拦截器，它继承了 <code>MyBatisPlusInterceptor</code> 类。<code>MyBatisPlusInterceptor</code> 类是 MyBatis-Plus 提供的默认拦截器类，它提供了一些基本的拦截功能，例如 SQL 过滤、事务管理、异常处理等等。在 <code>PaginationInnerInterceptor</code> 类中，我们重写了其中的一些方法，例如 <code>beforeQuery</code>,用于在查询之前进行分页处理。</p>
<p>在 <code>beforeQuery</code> 方法中，我们使用 <code>String.split()</code> 方法将查询语句分成多个部分，并将每个部分作为参数传递给 <code>MyBatisPlusInterceptor</code> 的 <code>beforeQuery</code> 方法。在 <code>beforeQuery</code> 方法中，我们可以使用 <code>MapperScannerConfigurer</code> 类来扫描和配置 Mapper 接口，以便在查询时执行相应的操作。</p>
<p>通过以上代码，我们可以在 MyBatis-Plus 中实现分页功能，而不需要修改 MyBatis-Plus 的源代码。同时，我们还可以在配置文件中定义 <code>@Bean</code> 方法来创建 <code>MybatisPlusInterceptor</code> 对象，以便在应用程序启动时自动配置 MyBatis-Plus，从而提高系统的可维护性和可扩展性。</p>
<h4 id="3-3-2-分页查询实现"><a href="#3-3-2-分页查询实现" class="headerlink" title="3.3.2 分页查询实现"></a>3.3.2 分页查询实现</h4><p>在上面我们已经分析了，页面在进行分页查询时， 具体的请求信息如下:</p>
<table>
<thead>
<tr>
<th>请求</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>请求方式</td>
<td>GET</td>
</tr>
<tr>
<td>请求路径</td>
<td>&#x2F;employee&#x2F;page</td>
</tr>
<tr>
<td>请求参数</td>
<td>page , pageSize , name</td>
</tr>
</tbody></table>
<p>那么查询完毕后我们需要给前端返回什么样的结果呢? </p>
<p>在上述我们也分析了, 查询返回的结果数据data中应该封装两项信息, 分别为: records 封装分页列表数据, total 中封装符合条件的总记录数。 那么这个时候, 在定义controller方法的返回值类型R时, 我们可以直接将 MybatisPlus 分页查询的结果 Page 直接封装返回, 因为Page中的属性如下: </p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021804283.png" alt="image-20210729235403154" style="zoom:80%;" /> 



<p>那么接下来就依据于这些已知的需求和条件完成分页查询的代码实现。 具体的逻辑如下: </p>
<p>A. 构造分页条件</p>
<p>B. 构建搜索条件 - name进行模糊匹配</p>
<p>C. 构建排序条件 - 更新时间倒序排序</p>
<p>D. 执行查询</p>
<p>E. 组装结果并返回</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">records   结果列表</span><br><span class="line">total     总记录数   </span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131539429.png" alt="image-20230606081950026"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131539309.png" alt="image-20230606082032620"></p>
<p>接收服务端的响应</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">await getMemberList(params).then(res =&gt; &#123;</span><br><span class="line">           if (String(res.code) === &#x27;1&#x27;) &#123;</span><br><span class="line">             this.tableData = res.data.records || []</span><br><span class="line">             this.counts = res.data.total</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>

<p>服务端响应回来的数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">this.tableData = res.data.records || []</span><br><span class="line">this.counts = res.data.total</span><br></pre></td></tr></table></figure>

<p>这就说明  我们响应的JSON里面  应该有records   total字段    而我们的Employee没有这二个字段   所以我们在EmployeeController里面使用的泛型应该是Page   Page是MybatisPlus给我们封装的一个类   一会我们进行分页查询   最终也会返回这个对象    如下图</p>
<p>在我们的Page里面有我们的.records和total属性  .records放着是当前页  展示的列表数据      total     总记录数   总条数    所以这里面为啥要使用Page  就是因为页面上要拿数据 records和total </p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131539517.png" alt="image-20230606081640494"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540157.png" alt="image-20230606083257213"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public  R&lt;Page&gt; page() &#123;</span><br><span class="line"></span><br><span class="line">       return  null;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540885.png" alt="image-20230606083713938"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line">   * 员工信息分页查询</span><br><span class="line">   * @param page 当前查询页码</span><br><span class="line">   * @param pageSize 每页展示记录数</span><br><span class="line">   * @param name 员工姓名 - 可选参数</span><br><span class="line">   * @return</span><br><span class="line">   */</span><br><span class="line">  @GetMapping(&quot;/page&quot;)</span><br><span class="line">    public  R&lt;Page&gt; page(int page ,int pageSize, String name) &#123;</span><br><span class="line">      log.info(&quot;page = &#123;&#125;,pageSize = &#123;&#125;,name = &#123;&#125;&quot; ,page,pageSize,name);</span><br><span class="line">       return  null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540813.png" alt="image-20230606084326216"></p>
<p>刷新 页面 并登录 </p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540365.png" alt="image-20230606084418940"></p>
<p>F8</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540037.png" alt="image-20230606084530751"></p>
<p>放行</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540621.png" alt="image-20230606084549836"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540085.png" alt="image-20230606084650465"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131540797.png" alt="image-20230606084723825"></p>
<p>具体的代码实现如下: </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工信息分页查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> page 当前查询页码</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageSize 每页展示记录数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name 员工姓名 - 可选参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R&lt;Page&gt; <span class="title function_">page</span><span class="params">(<span class="type">int</span> page,<span class="type">int</span> pageSize,String name)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;page = &#123;&#125;,pageSize = &#123;&#125;,name = &#123;&#125;&quot;</span> ,page,pageSize,name);</span><br><span class="line">    <span class="comment">//构造分页构造器</span></span><br><span class="line">    <span class="type">Page</span> <span class="variable">pageInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Page</span>(page,pageSize);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造条件构造器</span></span><br><span class="line">    LambdaQueryWrapper&lt;Employee&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>();</span><br><span class="line">    <span class="comment">//添加过滤条件</span></span><br><span class="line">    queryWrapper.like(StringUtils.isNotEmpty(name),Employee::getName,name);</span><br><span class="line">    <span class="comment">//添加排序条件</span></span><br><span class="line">    queryWrapper.orderByDesc(Employee::getUpdateTime);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行查询</span></span><br><span class="line">    employeeService.page(pageInfo,queryWrapper);</span><br><span class="line">    <span class="keyword">return</span> R.success(pageInfo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>代码解释1</p>
<p>以上代码是一个Java Spring Boot中的员工信息分页查询的接口方法。下面是对代码的解释：</p>
<ol>
<li><code>@GetMapping(&quot;/page&quot;)</code>: 这是一个GET请求的映射路径，用于处理分页查询请求。请求路径为<code>/page</code>。</li>
<li><code>public R&lt;Page&gt; page(int page, int pageSize, String name)</code>: 这是一个公共方法，返回类型为<code>R&lt;Page&gt;</code>，即包装了响应结果的对象。方法名为<code>page</code>，接受三个参数：<code>page</code>表示当前查询的页码，<code>pageSize</code>表示每页展示的记录数，<code>name</code>表示员工姓名（可选参数）。</li>
<li><code>log.info(&quot;page = &#123;&#125;,pageSize = &#123;&#125;,name = &#123;&#125;&quot;, page, pageSize, name)</code>: 这行代码用于输出日志，记录传入的参数值。</li>
<li><code>Page pageInfo = new Page(page, pageSize)</code>: 这是一个分页构造器，用于创建一个分页对象，传入当前查询的页码和每页展示的记录数。</li>
<li><code>LambdaQueryWrapper&lt;Employee&gt; queryWrapper = new LambdaQueryWrapper()</code>: 这是一个条件构造器，用于构建查询条件的对象。</li>
<li><code>queryWrapper.like(StringUtils.isNotEmpty(name), Employee::getName, name)</code>: 这行代码添加了一个模糊查询条件，根据员工姓名（<code>Employee</code>对象的<code>name</code>属性）进行模糊匹配。<code>StringUtils.isNotEmpty(name)</code>用于判断<code>name</code>参数是否非空，如果非空，则添加模糊查询条件；否则不添加该条件。</li>
<li><code>queryWrapper.orderByDesc(Employee::getUpdateTime)</code>: 这行代码添加了一个排序条件，根据员工的更新时间（<code>Employee</code>对象的<code>updateTime</code>属性）进行降序排序。</li>
<li><code>employeeService.page(pageInfo, queryWrapper)</code>: 这行代码执行查询操作，调用<code>employeeService</code>中的<code>page</code>方法，传入分页对象和查询条件对象，将查询结果封装到<code>pageInfo</code>对象中。</li>
<li><code>return R.success(pageInfo)</code>: 最后，将封装了查询结果的<code>pageInfo</code>对象作为响应结果，通过<code>R.success()</code>方法包装后返回。</li>
</ol>
<p>总体而言，该接口方法接受分页查询的参数，根据参数构建查询条件，并执行查询操作，返回包含查询结果的分页对象。</p>
<p>这里面的StringUtils是什么</p>
<p><code>StringUtils</code>是一个字符串处理工具类，通常是Apache Commons Lang库中的一个类。它提供了许多用于处理字符串的实用方法，例如判断字符串是否为空、去除字符串中的空格、比较字符串等。</p>
<p>在代码中，<code>StringUtils.isNotEmpty(name)</code>用于判断<code>name</code>参数是否为空。如果<code>name</code>不为空，则返回<code>true</code>；如果<code>name</code>为空或为null，则返回<code>false</code>。这个判断条件用于决定是否向查询条件中添加员工姓名的模糊查询条件。</p>
<p>需要注意的是，<code>StringUtils</code>类可以有不同的实现，而具体使用哪个实现取决于项目中引入的库和版本。</p>
<p>代码解释2</p>
<p>以上代码是一个简单的员工信息分页查询的 Spring Boot 应用程序，其功能是接收三个参数：当前查询页码 page、每页展示记录数 pageSize 和员工姓名 name，并返回一个成功响应 PageInfo 对象。</p>
<p>以下是对代码的详细解释:</p>
<ol>
<li><code>@GetMapping(&quot;/page&quot;)</code> 注解指定了请求路径为 &#x2F;page，并映射到 <code>page</code> 方法上。</li>
<li><code>log.info(&quot;page = &#123;&#125;,pageSize = &#123;&#125;,name = &#123;&#125;&quot; ,page,pageSize,name)</code> 方法中，使用了 <code>log.info</code> 方法输出了三个参数的值，分别是当前查询页码 page、每页展示记录数 pageSize 和员工姓名 name。</li>
<li><code>Page pageInfo = new Page(page,pageSize)</code> 创建了一个 PageInfo 对象 pageInfo，该对象用于封装分页信息和查询条件。其中，<code>page</code> 参数指定了当前查询页码，<code>pageSize</code> 参数指定了每页展示记录数。</li>
<li><code>LambdaQueryWrapper&lt;Employee&gt; queryWrapper = new LambdaQueryWrapper()</code> 创建了一个 LambdaQueryWrapper 对象 queryWrapper，该对象用于封装查询条件。其中，<code>Employee</code> 是员工信息类的泛型类型，<code>name</code> 参数指定了要查询的员工姓名。</li>
<li><code>queryWrapper.like(StringUtils.isNotEmpty(name),Employee::getName,name)</code> 添加了一个过滤条件，即对员工姓名进行模糊匹配。其中，<code>StringUtils.isNotEmpty(name)</code> 方法检查了 name 参数是否不为空，<code>Employee::getName</code> 方法引用了员工信息的类方法 getName，用于返回员工姓名。</li>
<li><code>queryWrapper.orderByDesc(Employee::getUpdateTime)</code> 添加了一个排序条件，即按照员工更新时间进行降序排序。</li>
<li><code>employeeService.page(pageInfo,queryWrapper)</code> 调用了 employeeService 的 page 方法，该方法接收两个参数:pageInfo 对象和 LambdaQueryWrapper 对象。pageInfo 对象用于封装分页信息和查询条件，LambdaQueryWrapper 对象用于封装查询条件。</li>
<li><code>return R.success(pageInfo)</code> 返回了一个成功响应对象 R，其中包含了分页信息和查询结果。</li>
</ol>
<p>综上所述，以上代码实现了一个简单的员工信息分页查询功能，接收三个参数：当前查询页码 page、每页展示记录数 pageSize 和员工姓名 name，并返回一个成功响应 PageInfo 对象。</p>
<p>代码解释3</p>
<p>以上代码是一个 Java SpringBoot 项目中的员工信息分页查询 API 接口，主要用于查询符合指定条件的员工列表，并分页展示。具体解释如下：</p>
<ol>
<li>@GetMapping(“&#x2F;page”) 注解表示这个接口处理 GET 请求，并注册了 &#x2F;page 的路径映射。</li>
<li>page、pageSize 和 name 这三个参数分别代表当前查询页码、每页展示记录数和员工姓名（可选），这些参数将作为接口的请求参数传入。</li>
<li>Page pageInfo &#x3D; new Page(page, pageSize) 给 pageInfo 对象赋值，page 是当前页码，pageSize 是每页展示记录数，这行代码构造了一个分页构造器对象并传入这两个参数，再将其赋值给 pageInfo。</li>
<li>LambdaQueryWrapper<Employee> queryWrapper &#x3D; new LambdaQueryWrapper() 构造一个条件构造器，用于构建 SQL 查询语句。</li>
<li>queryWrapper.like(StringUtils.isNotEmpty(name),Employee::getName,name) 给 queryWrapper 添加条件过滤器，如果 name 不为空，则查询名字中包含 name 的员工数据。其中 <code>Employee::getName</code> 表示使用 Employee 实体类的 getName 方法进行筛选操作。</li>
<li>queryWrapper.orderByDesc(Employee::getUpdateTime) 给 queryWrapper 添加排序条件，按照员工更新时间降序排列。其中 <code>Employee::getUpdateTime</code> 表示使用 Employee 实体类的 getUpdateTime 方法进行排序操作。</li>
<li>employeeService.page(pageInfo,queryWrapper) 执行查询，将查询结果存放在 pageInfo 对象中，最终返回 pageInfo。</li>
<li>最后，接口返回一个 R 类对象，使用 success 方法将 pageInfo 封装到响应体中。R 是一个通用的响应类，封装了接口响应的数据和状态等信息。</li>
</ol>
<h3 id="3-4-功能测试"><a href="#3-4-功能测试" class="headerlink" title="3.4 功能测试"></a>3.4 功能测试</h3><p>代码编写完毕之后，我们需要将工程重启, 完毕之后直接访问管理系统首页, 默认就会打开员工管理的列表页面, 我们可以查看列表数据是否可以正常展示, 也可以通过分页插件来测试分页功能, 及员工姓名的模糊查询功能。</p>
<p>在进行测试时，可以使用浏览器的监控工具查看页面和服务端的数据交互细节。 并借助于debug的形式， 根据服务端参数接收及逻辑执行情况。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805171.png" alt="image-20210730000855072"> </p>
<p>测试过程中可以发现，对于员工状态字段（status）服务端返回的是状态码（1或者0），但是页面上显示的则是“正常”或者“已禁用”，这是因为页面中在展示数据时进行了处理。</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805940.png" alt="image-20210730010606005" style="zoom:80%;" /> 



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541053.png" alt="image-20230606091026997"></p>
<p>F8    两次</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541749.png" alt="image-20230606091116014"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541021.png" alt="image-20230606091219400"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541861.png" alt="image-20230606091238699"></p>
<p>3次F8</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541653.png" alt="image-20230606091400825"></p>
<p>F8</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">==&gt;  Preparing: SELECT COUNT(*) FROM employee</span><br><span class="line">==&gt; Parameters: </span><br><span class="line">&lt;==    Columns: COUNT(*)</span><br><span class="line">&lt;==        Row: 4</span><br><span class="line">&lt;==      Total: 1</span><br><span class="line">==&gt;  Preparing: SELECT id,username,name,password,phone,sex,id_number,status,create_time,update_time,create_user,update_user FROM employee ORDER BY update_time DESC LIMIT ?</span><br><span class="line">==&gt; Parameters: 10(Long)</span><br><span class="line">&lt;==    Columns: id, username, name, password, phone, sex, id_number, status, create_time, update_time, create_user, update_user</span><br><span class="line">&lt;==        Row: 1665721390604546050, lisi, 李四, e10adc3949ba59abbe56e057f20f883e, 13528659545, 1, 358956221565220, 1, 2023-06-05 22:05:02, 2023-06-05 22:05:02, 1, 1</span><br><span class="line">&lt;==        Row: 1665562193044803586, zhangsan, zs, e10adc3949ba59abbe56e057f20f883e, 13412345678, 1, 350689566956852556, 1, 2023-06-05 11:32:26, 2023-06-05 11:32:26, 1, 1</span><br><span class="line">&lt;==        Row: 1665561007872905218, zhagsan, 张三, e10adc3949ba59abbe56e057f20f883e, 13412345678, 1, 350689566956852556, 1, 2023-06-05 11:27:44, 2023-06-05 11:27:44, 1, 1</span><br><span class="line">&lt;==        Row: 1, admin, 管理员, e10adc3949ba59abbe56e057f20f883e, 13812312312, 1, 110101199001010047, 1, 2021-05-06 17:20:07, 2021-05-10 02:24:09, 1, 1</span><br><span class="line">&lt;==      Total: 4</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541028.png" alt="image-20230606091552186"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131541445.png" alt="image-20230606091621319"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542660.png" alt="image-20230606091640224"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542324.png" alt="image-20230606091809618"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542565.png" alt="image-20230606091927990"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542620.png" alt="image-20230606092639214"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542584.png" alt="image-20230606092756034"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542949.png" alt="image-20230606092923413"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131542621.png" alt="image-20230606092948002"></p>
<h2 id="4-启用-x2F-禁用员工账号"><a href="#4-启用-x2F-禁用员工账号" class="headerlink" title="4. 启用&#x2F;禁用员工账号"></a>4. 启用&#x2F;禁用员工账号</h2><h3 id="4-1-需求分析"><a href="#4-1-需求分析" class="headerlink" title="4.1 需求分析"></a>4.1 需求分析</h3><p>在员工管理列表页面，可以对某个员工账号进行<font color='gree'>启用</font>或者<font color='red'>禁用</font>操作。账号禁用的员工不能登录系统，启用后的员工可以正常登录。如果某个员工账号状态为正常，则按钮显示为 “禁用”，如果员工账号状态为已禁用，则按钮显示为”启用”。</p>
<p>&#x3D;&#x3D;需要注意，只有管理员（admin用户）可以对其他普通用户进行启用、禁用操作，所以普通用户登录系统后启用、禁用按钮不显示。&#x3D;&#x3D;</p>
<p><strong>A. admin 管理员登录</strong></p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805875.png" alt="image-20210730010858705" style="zoom:80%;" /> 



<p><strong>B. 普通用户登录</strong></p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805876.png" alt="image-20210730010941399" style="zoom:80%;" /> 





<h3 id="4-2-程序执行流程"><a href="#4-2-程序执行流程" class="headerlink" title="4.2 程序执行流程"></a>4.2 程序执行流程</h3><h4 id="4-2-1-页面按钮动态展示"><a href="#4-2-1-页面按钮动态展示" class="headerlink" title="4.2.1 页面按钮动态展示"></a>4.2.1 页面按钮动态展示</h4><p>在上述的需求中,我们提到需要实现的效果是 : <strong>只有管理员（admin用户）可以对其他普通用户进行启用、禁用操作，所以普通用户登录系统后启用、禁用按钮不显示</strong> , 页面中是怎么做到只有管理员admin能够看到启用、禁用按钮的？</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131543430.png" alt="image-20230606161516664"></p>
<p>1). 在列表页面(list.html)加载时, 触发钩子函数created, 在钩子函数中, 会从localStorage中获取到用户登录信息, 然后获取到用户名</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131543117.png" alt="image-20230606161858341"></p>
<p>取到之后  给模型数据 user  </p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805956.png" alt="image-20210730012044171" style="zoom:80%;" /> 

<p>拿到模型数据 user 之后      通过Vue指令v-if进行判断,如果登录用户为admin将展示 启用&#x2F;禁用 按钮, 否则不展示</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/el-button&gt;</span><br><span class="line">   &lt;el-button</span><br><span class="line">     type=&quot;text&quot;</span><br><span class="line">     size=&quot;small&quot;</span><br><span class="line">     class=&quot;delBut non&quot;</span><br><span class="line">     @click=&quot;statusHandle(scope.row)&quot;</span><br><span class="line">     v-if=&quot;user === &#x27;admin&#x27;&quot; // 通过Vue指令v-if进行判断,如果登录用户为admin将展示 启用/禁用 按钮, 否则不展示</span><br><span class="line">   &gt;</span><br><span class="line">     &#123;&#123; scope.row.status == &#x27;1&#x27; ? &#x27;禁用&#x27; : &#x27;启用&#x27; &#125;&#125;</span><br><span class="line">   &lt;/el-button&gt;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131543889.png" alt="image-20230606162420563"></p>
<p>2). 在页面中, 通过Vue指令v-if进行判断,如果登录用户为admin将展示 启用&#x2F;禁用 按钮, 否则不展示</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805195.png" alt="image-20210730012256779" style="zoom:80%;" /> 



<h4 id="4-2-2-执行流程分析"><a href="#4-2-2-执行流程分析" class="headerlink" title="4.2.2 执行流程分析"></a>4.2.2 执行流程分析</h4><p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131543885.png" alt="image-20230606162658714"></p>
<p>1、页面发送ajax请求，将参数(id、status)提交到服务端</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131543443.png" alt="image-20230606162918904"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131543717.png" alt="image-20230606162934254"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131544148.png" alt="image-20230606162953705"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131544276.png" alt="image-20230606163014768"></p>
<p>2 、服务端Controller接收页面提交的数据并调用Service更新数据</p>
<p>3、Service调用Mapper操作数据库</p>
<p>为什么点击禁用或启用按钮  会发出请求</p>
<p>1). 当管理员admin点击 “启用” 或 “禁用” 按钮时, 调用方法statusHandle</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131544669.png" alt="image-20230606163342979"></p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805275.png" alt="image-20210730012723560" style="zoom:80%;" /> 

<blockquote>
<p>scope.row : 获取到的是这一行的数据信息 ;</p>
</blockquote>
<p>同时会传出scope.row过来   scope.row就是我们看到的数据 全封装的JSON对象</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131544852.png" alt="image-20230606163609077"></p>
<p>2). statusHandle方法中进行二次确认, 然后发起ajax请求, 传递id、status参数</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131544876.png" alt="image-20230606163716706"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//状态修改</span><br><span class="line">         statusHandle (row) &#123;</span><br><span class="line">           this.id = row.id    //获得id的值</span><br><span class="line">           this.status = row.status    //获得状态的值</span><br><span class="line">           this.$confirm(&#x27;确认调整该账号的状态?&#x27;, &#x27;提示&#x27;, &#123;</span><br><span class="line">             &#x27;confirmButtonText&#x27;: &#x27;确定&#x27;,</span><br><span class="line">             &#x27;cancelButtonText&#x27;: &#x27;取消&#x27;,</span><br><span class="line">             &#x27;type&#x27;: &#x27;warning&#x27;</span><br><span class="line">             &#125;).then(() =&gt; &#123;</span><br><span class="line">             enableOrDisableEmployee(&#123; &#x27;id&#x27;: this.id, &#x27;status&#x27;: !this.status ? 1 : 0 &#125;).then(res =&gt; &#123;</span><br><span class="line">               console.log(&#x27;enableOrDisableEmployee&#x27;,res)</span><br><span class="line">               if (String(res.code) === &#x27;1&#x27;) &#123;</span><br><span class="line">                 this.$message.success(&#x27;账号状态更改成功！&#x27;)</span><br><span class="line">                 this.handleQuery()</span><br><span class="line">               &#125;</span><br><span class="line">             &#125;).catch(err =&gt; &#123;</span><br><span class="line">               this.$message.error(&#x27;请求出错了：&#x27; + err)</span><br><span class="line">             &#125;)</span><br><span class="line">           &#125;)</span><br><span class="line">         &#125;,</span><br></pre></td></tr></table></figure>







<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021805043.png" alt="image-20210730013011861" style="zoom:80%;" /> 



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131545498.png" alt="image-20230606164539702"></p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021806003.png" alt="image-20210730013210948" style="zoom:80%;" /> 



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 修改---启用禁用接口</span><br><span class="line">function enableOrDisableEmployee (params) &#123;</span><br><span class="line">  return $axios(&#123;</span><br><span class="line">    url: &#x27;/employee&#x27;,</span><br><span class="line">    method: &#x27;put&#x27;,</span><br><span class="line">    data: &#123; ...params &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>最终发起异步请求, 请求服务端, 请求信息如下： </p>
<table>
<thead>
<tr>
<th>请求</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>请求方式</td>
<td>PUT</td>
</tr>
<tr>
<td>请求路径</td>
<td>&#x2F;employee</td>
</tr>
<tr>
<td>请求参数</td>
<td>{“id”:xxx,”status”:xxx}</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>{…params}</strong> : 三点是ES6中出现的扩展运算符。作用是遍历当前使用的对象能够访问到的所有属性，并将属性放入当前对象中。</p>
</blockquote>
<h3 id="4-3-代码实现"><a href="#4-3-代码实现" class="headerlink" title="4.3 代码实现"></a>4.3 代码实现</h3><p>在开发代码之前，需要梳理一下整个程序的执行过程：</p>
<p>1). 页面发送ajax请求，将参数(id、status)提交到服务端</p>
<p>2). 服务端Controller接收页面提交的数据并调用Service更新数据</p>
<p>3). Service调用Mapper操作数据库</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 根据id修改员工信息</span><br><span class="line"> * @param employee</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@PutMapping</span><br><span class="line">public R&lt;String&gt; update(@RequestBody Employee employee)&#123;</span><br><span class="line">    </span><br><span class="line">    log.info(employee.toString());</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131545374.png" alt="image-20230606170213213"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131550246.png" alt="image-20230606170238827"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131550257.png" alt="image-20230606170309899"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131550686.png" alt="image-20230606170402306"></p>
<p>启用、禁用员工账号，本质上就是一个更新操作，也就是对status状态字段进行操作。在Controller中创建update方法，此方法是一个通用的修改员工信息的方法。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id修改员工信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">update</span><span class="params">(HttpServletRequest request,<span class="meta">@RequestBody</span> Employee employee)</span>&#123;</span><br><span class="line">    log.info(employee.toString());</span><br><span class="line"></span><br><span class="line">    <span class="type">Long</span> <span class="variable">empId</span> <span class="operator">=</span> (Long)request.getSession().getAttribute(<span class="string">&quot;employee&quot;</span>);</span><br><span class="line"></span><br><span class="line">    employee.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    employee.setUpdateUser(empId);</span><br><span class="line">    employeeService.updateById(employee);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;员工信息修改成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131550918.png" alt="image-20230606170846979"></p>
<p>代码解释1</p>
<p>以上代码是一个Java Spring Boot框架中的控制器方法。代码使用了<code>@PutMapping</code>注解，表示该方法处理HTTP的PUT请求。</p>
<p>方法的目的是根据提供的员工ID（通过<code>request.getSession().getAttribute(&quot;employee&quot;)</code>获取）来修改员工信息。方法的参数包括<code>HttpServletRequest</code>对象和<code>Employee</code>对象，其中<code>HttpServletRequest</code>对象用于获取当前会话中的员工ID，<code>Employee</code>对象包含了需要更新的员工信息。</p>
<p>代码的执行步骤如下：</p>
<ol>
<li>首先，日志记录器<code>log</code>会打印出<code>employee</code>对象的字符串表示，以便在日志中查看传入的员工信息。</li>
<li>通过<code>request.getSession().getAttribute(&quot;employee&quot;)</code>获取当前会话中的员工ID，并将其赋值给<code>empId</code>变量。</li>
<li>使用<code>LocalDateTime.now()</code>获取当前的时间，并将其设置为员工信息的更新时间。</li>
<li>将<code>empId</code>设置为员工信息的更新用户。</li>
<li>调用<code>employeeService.updateById(employee)</code>方法来更新数据库中对应员工ID的员工信息。</li>
<li>最后，返回一个成功的<code>R</code>对象，包含了一个消息字符串”员工信息修改成功”。</li>
</ol>
<p>需要注意的是，代码中的<code>R&lt;String&gt;</code>表示返回一个包含泛型为<code>String</code>的<code>R</code>对象。<code>R</code>可能是自定义的响应对象，其中包含了一些用于表示请求结果的字段，例如状态码、消息等。具体实现可能需要查看项目中的相关代码。</p>
<p>在详细一点</p>
<p>以上代码是一个Java Spring Boot框架中的控制器方法。代码使用了<code>@PutMapping</code>注解，表示该方法处理HTTP的PUT请求。</p>
<p>方法的目的是根据提供的员工ID（通过<code>request.getSession().getAttribute(&quot;employee&quot;)</code>获取）来修改员工信息。方法的参数包括<code>HttpServletRequest</code>对象和<code>Employee</code>对象，其中<code>HttpServletRequest</code>对象用于获取当前会话中的员工ID，<code>Employee</code>对象包含了需要更新的员工信息。</p>
<p>代码的执行步骤如下：</p>
<ol>
<li>首先，日志记录器<code>log</code>会打印出<code>employee</code>对象的字符串表示，以便在日志中查看传入的员工信息。</li>
<li>通过<code>request.getSession().getAttribute(&quot;employee&quot;)</code>获取当前会话中的员工ID，并将其赋值给<code>empId</code>变量。</li>
<li>使用<code>LocalDateTime.now()</code>获取当前的时间，并将其设置为员工信息的更新时间。</li>
<li>将<code>empId</code>设置为员工信息的更新用户。</li>
<li>调用<code>employeeService.updateById(employee)</code>方法来更新数据库中对应员工ID的员工信息。</li>
<li>最后，返回一个成功的<code>R</code>对象，包含了一个消息字符串”员工信息修改成功”。</li>
</ol>
<p>需要注意的是，代码中的<code>R&lt;String&gt;</code>表示返回一个包含泛型为<code>String</code>的<code>R</code>对象。<code>R</code>可能是自定义的响应对象，其中包含了一些用于表示请求结果的字段，例如状态码、消息等。具体实现可能需要查看项目中的相关代码。</p>
<p>不明白的点</p>
<p>方法的参数有两个：HttpServletRequest对象和Employee对象。HttpServletRequest对象用于获取当前会话中的员工ID，Employee对象包含了需要更新的员工信息。</p>
<p>非常抱歉，我解释中的那部分可能不够清晰。我将重新解释方法的参数以及它们的作用。</p>
<ol>
<li><p>HttpServletRequest对象：HttpServletRequest是Java Servlet中的一个类，它表示客户端发出的HTTP请求。在这个方法中，我们将HttpServletRequest对象作为参数传递进来，以便获取当前会话中的员工ID。</p>
<p>当前会话是指与客户端（通常是Web浏览器）的交互过程中，服务器保持的关于该客户端的信息。会话可以跨多个HTTP请求，并且在整个会话期间保持活动状态。通过HttpServletRequest对象，我们可以获取与会话相关的信息，例如会话中存储的属性值。</p>
<p>在这段代码中，我们使用<code>request.getSession().getAttribute(&quot;employee&quot;)</code>来获取会话中名为”employee”的属性值。这个属性值应该是当前登录员工的ID。</p>
</li>
<li><p>Employee对象：Employee是一个自定义的类，它表示员工的信息。在这个方法中，我们将Employee对象作为参数传递进来，其中包含了需要更新的员工信息。</p>
<p>Employee对象通常具有多个属性，例如姓名、职位、薪水等。在这段代码中，我们传入的Employee对象应该包含了需要进行更新的员工信息。通过这个对象，我们可以获取和设置员工的各种属性值。</p>
<p>在方法的后续代码中，我们将使用Employee对象的方法来设置员工的更新时间和更新用户，然后将其传递给一个名为<code>updateById</code>的方法，以便在数据库中更新员工的信息。</p>
</li>
</ol>
<p>总结：HttpServletRequest对象用于获取当前会话中的员工ID，而Employee对象包含了需要更新的员工信息。通过这两个参数，我们可以获取员工ID和更新的员工信息，并进行相应的操作，例如记录更新时间和更新用户，然后进行数据库的更新操作。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131550358.png" alt="image-20230606181406229"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131550262.png" alt="image-20230606181518082"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131551383.png" alt="image-20230606181535268"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131551952.png" alt="image-20230606181604732"></p>
<p>5次F8</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131551679.png" alt="image-20230606184045746"></p>
<p>id不正确  更新失败</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131552765.png" alt="image-20230606184440220"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131552126.png" alt="image-20230606184537335"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131552710.png" alt="image-20230606184649800"></p>
<p>正确id</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131552901.png" alt="image-20230606184506867"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131553078.png" alt="image-20230606185224571"></p>
<h3 id="4-4-功能测试"><a href="#4-4-功能测试" class="headerlink" title="4.4 功能测试"></a>4.4 功能测试</h3><p>代码编写完毕之后，我们需要将工程重启。 然后访问前端页面， 进行 “启用” 或 “禁用” 的测试。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021806965.png" alt="image-20210730123213103"> </p>
<p>测试过程中没有报错，但是功能并没有实现，查看数据库中的数据也没有变化。但是从控制台输出的日志， 可以看出确实没有更新成功。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021806475.png" alt="image-20210730123307452"> </p>
<p>而在我们的数据库表结构中， 并不存在该ID， 数据库中 风清扬 对应的ID为 1420038345634918401</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021806756.png" alt="image-20210730123519468"> </p>
<h3 id="4-5-代码修复"><a href="#4-5-代码修复" class="headerlink" title="4.5 代码修复"></a>4.5 代码修复</h3><h4 id="4-5-1-原因分析"><a href="#4-5-1-原因分析" class="headerlink" title="4.5.1 原因分析"></a>4.5.1 原因分析</h4><p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021806412.png" alt="image-20210730123833129"> </p>
<p>通过观察控制台输出的SQL发现页面传递过来的员工id的值和数据库中的id值不一致，这是怎么回事呢？</p>
<p>在分页查询时，服务端会将返回的R对象进行json序列化，转换为json格式的数据，而员工的ID是一个Long类型的数据，而且是一个长度为 19 位的长整型数据， 该数据返回给前端是没有问题的。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021806699.png" alt="image-20210730124036415"> </p>
<p><strong>那么具体的问题出现在哪儿呢？</strong></p>
<p>问题实际上， 就出现在前端JS中， js在对长度较长的长整型数据进行处理时， 会损失精度， 从而导致提交的id和数据库中的id不一致。 这里，我们也可以做一个简单的测试，代码如下： </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">        alert(1420038345634918401);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="4-5-2-解决方案"><a href="#4-5-2-解决方案" class="headerlink" title="4.5.2 解决方案"></a>4.5.2 解决方案</h4><p>要想解决这个问题，也很简单，我们只需要让js处理的ID数据类型为字符串类型即可, 这样就不会损失精度了。同样， 大家也可以做一个测试： </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;1420038345634918401&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>那么在我们的业务中, 我们只需要让分页查询返回的json格式数据库中, long类型的属性, 不直接转换为数字类型, 转换为字符串类型就可以解决这个问题了 , 最终返回的结果为 : </p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021807347.png" alt="image-20210730125138652"> </p>
<h4 id="4-5-3-代码修复"><a href="#4-5-3-代码修复" class="headerlink" title="4.5.3 代码修复"></a>4.5.3 代码修复</h4><p>由于在SpringMVC中, 将Controller方法返回值转换为json对象, 是通过jackson来实现的, 涉及到SpringMVC中的一个消息转换器MappingJackson2HttpMessageConverter, 所以我们要解决这个问题, 就需要对该消息转换器的功能进行拓展。</p>
<p><strong>具体实现步骤：</strong></p>
<p>1). 提供对象转换器JacksonObjectMapper，基于Jackson进行Java对象到json数据的转换（资料中已经提供，直接复制到项目中使用）</p>
<p>2). 在WebMvcConfig配置类中扩展Spring mvc的消息转换器，在此消息转换器中使用提供的对象转换器进行Java对象到json数据的转换</p>
<p><strong>1). 引入JacksonObjectMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.DeserializationFeature;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.<span class="keyword">module</span>.SimpleModule;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ser.std.ToStringSerializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalDateDeserializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalTimeDeserializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalDateSerializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalTimeSerializer;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalTime;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.fasterxml.jackson.databind.DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对象映射器:基于jackson将Java对象转为json，或者将json转为Java对象</span></span><br><span class="line"><span class="comment"> * 将JSON解析为Java对象的过程称为 [从JSON反序列化Java对象]</span></span><br><span class="line"><span class="comment"> * 从Java对象生成JSON的过程称为 [序列化Java对象到JSON]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JacksonObjectMapper</span> <span class="keyword">extends</span> <span class="title class_">ObjectMapper</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_DATE_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_DATE_TIME_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_TIME_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;HH:mm:ss&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JacksonObjectMapper</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="comment">//收到未知属性时不报异常</span></span><br><span class="line">        <span class="built_in">this</span>.configure(FAIL_ON_UNKNOWN_PROPERTIES, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//反序列化时，属性不存在的兼容处理</span></span><br><span class="line">        <span class="built_in">this</span>.getDeserializationConfig().withoutFeatures(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);</span><br><span class="line"></span><br><span class="line">        <span class="type">SimpleModule</span> <span class="variable">simpleModule</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleModule</span>()</span><br><span class="line">                .addDeserializer(LocalDateTime.class, <span class="keyword">new</span> <span class="title class_">LocalDateTimeDeserializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_TIME_FORMAT)))</span><br><span class="line">                .addDeserializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateDeserializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)))</span><br><span class="line">                .addDeserializer(LocalTime.class, <span class="keyword">new</span> <span class="title class_">LocalTimeDeserializer</span>(DateTimeFormatter.ofPattern(DEFAULT_TIME_FORMAT)))</span><br><span class="line"></span><br><span class="line">                .addSerializer(BigInteger.class, ToStringSerializer.instance)</span><br><span class="line">                .addSerializer(Long.class, ToStringSerializer.instance)</span><br><span class="line"></span><br><span class="line">                .addSerializer(LocalDateTime.class, <span class="keyword">new</span> <span class="title class_">LocalDateTimeSerializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_TIME_FORMAT)))</span><br><span class="line">                .addSerializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateSerializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)))</span><br><span class="line">                .addSerializer(LocalTime.class, <span class="keyword">new</span> <span class="title class_">LocalTimeSerializer</span>(DateTimeFormatter.ofPattern(DEFAULT_TIME_FORMAT)));</span><br><span class="line">        <span class="comment">//注册功能模块 例如，可以添加自定义序列化器和反序列化器</span></span><br><span class="line">        <span class="built_in">this</span>.registerModule(simpleModule);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该自定义的对象转换器, 主要指定了, 在进行json数据序列化及反序列化时, LocalDateTime、LocalDate、LocalTime的处理方式, 以及BigInteger及Long类型数据，直接转换为字符串。</p>
<p><strong>2). 在WebMvcConfig中重写方法extendMessageConverters</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 扩展mvc框架的消息转换器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> converters</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;扩展消息转换器...&quot;</span>);</span><br><span class="line">    <span class="comment">//创建消息转换器对象</span></span><br><span class="line">    <span class="type">MappingJackson2HttpMessageConverter</span> <span class="variable">messageConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>();</span><br><span class="line">    <span class="comment">//设置对象转换器，底层使用Jackson将Java对象转为json</span></span><br><span class="line">    messageConverter.setObjectMapper(<span class="keyword">new</span> <span class="title class_">JacksonObjectMapper</span>());</span><br><span class="line">    <span class="comment">//将上面的消息转换器对象追加到mvc框架的转换器集合中</span></span><br><span class="line">    converters.add(<span class="number">0</span>,messageConverter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131553415.png" alt="image-20230606191322076"></p>
<p>测试</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131553663.png" alt="image-20230606191558145"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131553038.png" alt="image-20230606191638850"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131553871.png" alt="image-20230606191653555"></p>
<p>4次  F8</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554063.png" alt="image-20230606191801577"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554799.png" alt="image-20230606191934221"></p>
<p>放行</p>
<p>重新启动</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554310.png" alt="image-20230606192207403"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554974.png" alt="image-20230606192317429"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554126.png" alt="image-20230606192342809"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554438.png" alt="image-20230606192403783"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131554302.png" alt="image-20230606192442798"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131555469.png" alt="image-20230606192613884"></p>
<h2 id="5-编辑员工信息"><a href="#5-编辑员工信息" class="headerlink" title="5. 编辑员工信息"></a>5. 编辑员工信息</h2><p>在开发代码之前需要梳理一下操作过程和对应的程序的执行流程：<br>1、点击编辑按钮时，页面跳转到add.html，并在url中携带参数[员工id]<br>2、在add.html页面获取url中的参数[员工id]<br>3、发送ajax请求，请求服务端，同时提交员工id参数<br>4、服务端接收请求，根据员工id查询员工信息，将员工信息以json形式响应给页面<br>5、页面接收服务端响应的json数据，通过VUE的数据绑定进行员工信息回显<br>6、点击保存按钮，发送ajax请求，将页面中的员工信息以json方式提交给服务端<br>7、服务端接收员工信息，并进行处理，完成后给页面响应<br>8、页面接收到服务端响应信息后进行相应处理</p>
<p>注意：add.html页面为公共页面，新增员工和编辑员工都是在此页面操作</p>
<p>1、点击编辑按钮时，页面跳转到add.html，并在url中携带参数[员工id]</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131555057.png" alt="image-20230613140125600"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306142117010.png" alt="image-20230613140243231"></p>
<p>2、在add.html页面获取url中的参数[员工id]</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131555202.png" alt="image-20230613140358547"></p>
<p>3、发送ajax请求，请求服务端，同时提交员工id参数<br>4、服务端接收请求，根据员工id查询员工信息，将员工信息以json形式响应给页面</p>
<p>5、页面接收服务端响应的json数据，通过VUE的数据绑定进行员工信息回显</p>
<p>我们刚才看到的报的404   把这个id作为请求路径的一部分</p>
<p>为什么要发送请求</p>
<p>因为我们的服务端接收到请求之后  可以根据id去查询用户   然后回显到页面上  以JSON的形式响应给页面</p>
<p>页面接收服务端响应的json数据，通过VUE的数据绑定进行员工信息回显</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131555540.png" alt="image-20230613140611268"></p>
<p>注意点：</p>
<p>在修改的过程中有两次与服务端进行交互</p>
<p>第一次    发送请求  查询相对应的数据进行回显</p>
<p>第二次    当我们点击保存按钮的时候  把我们修改之后的数据 提交到我们的服务端</p>
<h3 id="5-1-需求分析"><a href="#5-1-需求分析" class="headerlink" title="5.1 需求分析"></a>5.1 需求分析</h3><p>在员工管理列表页面点击 “编辑” 按钮，跳转到编辑页面，在编辑页面回显员工信息并进行修改，最后点击 “保存” 按钮完成编辑操作。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021807123.png" alt="image-20210730181733784"> </p>
<p>那么从上述的分析中，我们可以看出当前实现的编辑功能,我们需要实现两个方法:</p>
<p>A. 根据ID查询, 用于页面数据回显</p>
<p>B. 保存修改</p>
<p>执行流程（视频版本）</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131555348.png" alt="image-20230613143736690"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131555106.png" alt="image-20230613143819149"></p>
<h3 id="5-2-程序执行流程"><a href="#5-2-程序执行流程" class="headerlink" title="5.2 程序执行流程"></a>5.2 程序执行流程</h3><p>在开发代码之前需要梳理一下操作过程和对应的程序的执行流程：</p>
<p>1). 点击编辑按钮时，页面跳转到add.html，并在url中携带参数[员工id]</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021807323.png" alt="image-20210730225514330"> </p>
<p>2). 在add.html页面获取url中的参数[员工id]</p>
<p>3). 发送ajax请求，请求服务端，同时提交员工id参数</p>
<p>4). 服务端接收请求，根据员工id查询员工信息，将员工信息以json形式响应给页面</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021807595.png" alt="image-20210730230005437"> </p>
<p>5). 页面接收服务端响应的json数据，通过VUE的数据绑定进行员工信息回显</p>
<p>6). 点击保存按钮，发送ajax请求，将页面中的员工信息以json方式提交给服务端</p>
<p>7). 服务端接收员工信息，并进行处理，完成后给页面响应</p>
<p>8). 页面接收到服务端响应信息后进行相应处理</p>
<img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202304021807419.png" alt="image-20210730230533123" style="zoom:80%;" /> 



<blockquote>
<p>注意：add.html页面为公共页面，新增员工和编辑员工都是在此页面操作</p>
</blockquote>
<h3 id="5-3-代码实现"><a href="#5-3-代码实现" class="headerlink" title="5.3 代码实现"></a>5.3 代码实现</h3><h4 id="5-3-1-根据ID查询"><a href="#5-3-1-根据ID查询" class="headerlink" title="5.3.1 根据ID查询"></a>5.3.1 根据ID查询</h4><p>经过上述的分析,我们看到,在根据ID查询员工信息时,请求信息如下: </p>
<table>
<thead>
<tr>
<th>请求</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>请求方式</td>
<td>GET</td>
</tr>
<tr>
<td>请求路径</td>
<td>&#x2F;employee&#x2F;{id}</td>
</tr>
</tbody></table>
<p><strong>代码实现:</strong> </p>
<p>在EmployeeController中增加方法, 根据ID查询员工信息。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id查询员工信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R&lt;Employee&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;根据id查询员工信息...&quot;</span>);</span><br><span class="line">    <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeService.getById(id);</span><br><span class="line">    <span class="keyword">if</span>(employee != <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> R.success(employee);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> R.error(<span class="string">&quot;没有查询到对应员工信息&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>代码解释</p>
<p>解释1 </p>
<p>以上代码是一个基于Spring框架的Java代码片段，用于实现一个RESTful API接口。代码中包含了一个GET请求方法，用于根据员工ID查询员工信息。</p>
<p>解释如下：</p>
<ol>
<li><code>@GetMapping(&quot;/&#123;id&#125;&quot;)</code>：这是一个注解，指定了HTTP GET请求的URL路径。<code>/&#123;id&#125;</code>表示该路径中需要包含一个名为id的路径参数。</li>
<li><code>public R&lt;Employee&gt; getById(@PathVariable Long id)</code>：这是一个公共方法，返回类型为R<Employee>。R是一个自定义的响应对象，用于封装API接口的返回结果。方法名为getById，接收一个名为id的路径参数。</li>
<li><code>log.info(&quot;根据id查询员工信息...&quot;)</code>：这是一个日志输出语句，用于在日志中记录一条信息，表示正在执行根据员工ID查询员工信息的操作。</li>
<li><code>Employee employee = employeeService.getById(id)</code>：这是调用一个名为employeeService的服务对象的getById方法，传入id参数，用于根据员工ID查询员工信息。查询结果会保存在employee对象中。</li>
<li><code>if(employee != null)</code>：如果查询到了员工信息（employee不为null），则执行下一行代码；否则，执行返回错误信息的逻辑。</li>
<li><code>return R.success(employee)</code>：如果查询到了员工信息，将员工信息作为成功响应的数据，使用R.success方法封装响应结果，然后返回。</li>
<li><code>return R.error(&quot;没有查询到对应员工信息&quot;)</code>：如果没有查询到员工信息，将错误信息作为错误响应的数据，使用R.error方法封装响应结果，然后返回。</li>
</ol>
<p>总体而言，这段代码实现了一个GET请求接口，通过传入员工ID来查询对应的员工信息，并将查询结果通过自定义的响应对象R进行封装后返回。</p>
<p>解释2</p>
<p>当客户端发送一个GET请求到指定的URL路径时（例如：<code>/&#123;id&#125;</code>），该方法会被执行。在这个URL路径中，我们期望包含一个名为id的路径参数，以便指定要查询的员工的ID。</p>
<p>在方法体内部，首先通过日志输出记录正在执行的操作，即根据员工ID查询员工信息。</p>
<p>然后，通过调用一个名为employeeService的服务对象的getById方法，将传入的id参数作为查询条件，来获取对应的员工信息。查询结果将保存在名为employee的对象中。</p>
<p>接下来，通过判断employee对象是否为null来判断是否成功查询到员工信息。如果employee不为null，表示查询成功，将员工信息作为成功响应的数据。代码使用R.success方法将响应结果封装为一个成功响应对象R，并将其返回给客户端。</p>
<p>如果employee为null，表示没有查询到对应的员工信息，代码使用R.error方法将错误信息封装为一个错误响应对象R，并将其返回给客户端。</p>
<p>简而言之，该代码片段实现了一个GET请求接口，客户端通过传递员工ID来查询对应的员工信息。如果查询成功，返回包含员工信息的成功响应；如果查询失败，返回包含错误信息的错误响应。</p>
<p>详细解释    Employee employee &#x3D; employeeService.getById(id);   这点不是很明白  能不能在详细解释一下</p>
<p>当代码执行到<code>Employee employee = employeeService.getById(id);</code>这一行时，它调用了名为<code>employeeService</code>的服务对象的<code>getById</code>方法，并传递了<code>id</code>参数。</p>
<p>在代码中，<code>employeeService</code>是一个封装了员工相关操作的服务对象。通过调用<code>getById</code>方法，它会根据传入的<code>id</code>参数查询对应的员工信息。</p>
<p>这里的<code>getById</code>方法可能会包含数据库查询操作或者其他方式的数据获取逻辑，具体实现取决于<code>employeeService</code>对象的具体实现。它会根据传入的<code>id</code>参数查询数据库或其他数据源，以获取对应<code>id</code>的员工信息。</p>
<p>查询结果将会被存储在名为<code>employee</code>的<code>Employee</code>对象中。这个对象将包含查询到的员工信息，例如姓名、职位、工资等。</p>
<p>最后，<code>employee</code>对象将用于后续的判断和处理。根据查询结果，代码会决定返回成功响应（包含<code>employee</code>对象作为响应数据）或者返回错误响应（表示没有查询到对应的员工信息）。</p>
<p>总而言之，<code>Employee employee = employeeService.getById(id);</code>这一行代码的作用是调用服务对象的方法来获取对应<code>id</code>的员工信息，并将查询结果存储在名为<code>employee</code>的对象中，以供后续处理和返回响应使用。</p>
<p><code>employeeService</code>是一个处理员工信息的服务对象。<code>getById</code>方法是该服务对象中的一个功能，它的作用是根据传入的员工ID来获取相应的员工信息。</p>
<p>在代码中，通过<code>employeeService.getById(id)</code>这一行，程序会调用<code>getById</code>方法，并传入<code>id</code>作为参数。这样，<code>getById</code>方法就知道要查询哪个员工的信息。</p>
<p><code>getById</code>方法会根据提供的<code>id</code>，在数据库或其他数据源中查找相应的员工信息。查询的结果将会被赋值给一个叫<code>employee</code>的变量，它是一个<code>Employee</code>类型的对象。</p>
<p>最后，根据查询结果的情况，代码会决定返回成功响应或错误响应。如果成功找到了员工信息，就会将<code>employee</code>作为成功响应的数据返回。如果没有找到对应的员工信息，就会返回一个错误提示。</p>
<p>简单来说，这段代码的目的是根据传入的员工ID，通过调用<code>employeeService</code>的<code>getById</code>方法来获取对应员工的信息，并根据查询结果返回相应的响应。</p>
<p><code>Employee employee = employeeService.getById(id);</code> 表示获取员工信息的对象实例。</p>
<p><code>employeeService</code> 是一个依赖注入的 Bean，它实现了 <code>EmployeeService</code> 接口，该接口定义了 <code>getById</code> 方法，方法的参数为 <code>id</code>,返回值为 <code>Employee</code> 对象。</p>
<p><code>getById</code> 方法的实现是通过调用数据库中存储的员工信息的 <code>id</code> 字段来获取员工信息的对象实例。如果数据库中的员工信息与传入的 <code>id</code> 值匹配，则返回员工信息的对象实例，否则返回 <code>null</code>。</p>
<p>由于此接口定义为 RESTful API，因此返回的员工信息对象实例应该遵循 HTTP 响应状态码和响应头规范。通常情况下，响应状态码为 200(成功) 或 404(未找到资源)。</p>
<p>在以上代码中，如果员工信息不为空，则返回响应对象 <code>R.success(employee)</code>,表示员工信息已成功查询到;否则，返回错误响应 <code>R.error(&quot;没有查询到对应员工信息&quot;)</code>,表示无法查询到员工信息。</p>
<p>测试</p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131556298.png" alt="image-20230613151354875"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131557745.png" alt="image-20230613151639165"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131557489.png" alt="image-20230613151926222"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131557465.png" alt="image-20230613152129407"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zyziga/picodemo/takeaway/day02/202306131557210.png" alt="image-20230613152222794"></p>
<h4 id="5-3-2-修改员工"><a href="#5-3-2-修改员工" class="headerlink" title="5.3.2 修改员工"></a>5.3.2 修改员工</h4><p>经过上述的分析,我们看到,在修改员工信息时,请求信息如下: </p>
<table>
<thead>
<tr>
<th>请求</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>请求方式</td>
<td>PUT</td>
</tr>
<tr>
<td>请求路径</td>
<td>&#x2F;employee</td>
</tr>
<tr>
<td>请求参数</td>
<td>{…….} json格式数据</td>
</tr>
</tbody></table>
<p><strong>代码实现:</strong> </p>
<p>在EmployeeController中增加方法, 根据ID更新员工信息。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id修改员工信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">update</span><span class="params">(HttpServletRequest request,<span class="meta">@RequestBody</span> Employee employee)</span>&#123;</span><br><span class="line">    log.info(employee.toString());</span><br><span class="line"></span><br><span class="line">    <span class="type">Long</span> <span class="variable">empId</span> <span class="operator">=</span> (Long)request.getSession().getAttribute(<span class="string">&quot;employee&quot;</span>);</span><br><span class="line"></span><br><span class="line">    employee.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    employee.setUpdateUser(empId);</span><br><span class="line">    employeeService.updateById(employee);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;员工信息修改成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-4-功能测试"><a href="#5-4-功能测试" class="headerlink" title="5.4 功能测试"></a>5.4 功能测试</h3><p>代码编写完毕之后，我们需要将工程重启。 然后访问前端页面， 按照前面分析的操作流程进行测试，查看数据是否正常修改即可。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://zyziga.github.io">姜小白</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zyziga.github.io/archives/1.html">https://zyziga.github.io/archives/1.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zyziga.github.io" target="_blank">姜小白程序</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/0.html" title="瑞吉外卖-Day01"><img class="cover" src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">瑞吉外卖-Day01</div></div></a></div><div class="next-post pull-right"><a href="/archives/2.html" title="瑞吉外卖-Day03"><img class="cover" src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">瑞吉外卖-Day03</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/milos.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">姜小白</div><div class="author-info__description">姜小白程序</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/zyziga/zyziga.github.io"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zyziga" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/Hexo.zyziga.github.io" target="_blank" title="博客"><i class="fas fa-thin fa-truck"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到姜小白的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96-Day02"><span class="toc-text">瑞吉外卖-Day02</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9"><span class="toc-text">课程内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AE%8C%E5%96%84%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="toc-text">1. 完善登录功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="toc-text">1.1 问题分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-text">1.2 思路分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">1.3 代码实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-text">1.4 功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%96%B0%E5%A2%9E%E5%91%98%E5%B7%A5"><span class="toc-text">2. 新增员工</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">2.1 需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-text">2.2 数据模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">2.3 程序执行流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">2.4 代码实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-text">2.5 功能测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-text">2.6 全局异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-text">2.6.1 思路分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-2-%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-text">2.6.2 全局异常处理器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-3-%E6%B5%8B%E8%AF%95"><span class="toc-text">2.6.3 测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%91%98%E5%B7%A5%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">3. 员工分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">3.1 需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">3.2 程序执行流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E9%A1%B5%E9%9D%A2%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="toc-text">3.2.1 页面流程分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E4%BB%8B%E7%BB%8D"><span class="toc-text">3.2.2 前端代码介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">3.3 代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="toc-text">3.3.1 分页插件配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%AE%9E%E7%8E%B0"><span class="toc-text">3.3.2 分页查询实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-text">3.4 功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%90%AF%E7%94%A8-x2F-%E7%A6%81%E7%94%A8%E5%91%98%E5%B7%A5%E8%B4%A6%E5%8F%B7"><span class="toc-text">4. 启用&#x2F;禁用员工账号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">4.1 需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">4.2 程序执行流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E9%A1%B5%E9%9D%A2%E6%8C%89%E9%92%AE%E5%8A%A8%E6%80%81%E5%B1%95%E7%A4%BA"><span class="toc-text">4.2.1 页面按钮动态展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="toc-text">4.2.2 执行流程分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">4.3 代码实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-text">4.4 功能测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E4%BB%A3%E7%A0%81%E4%BF%AE%E5%A4%8D"><span class="toc-text">4.5 代码修复</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-1-%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90"><span class="toc-text">4.5.1 原因分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-2-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">4.5.2 解决方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-3-%E4%BB%A3%E7%A0%81%E4%BF%AE%E5%A4%8D"><span class="toc-text">4.5.3 代码修复</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BC%96%E8%BE%91%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF"><span class="toc-text">5. 编辑员工信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">5.1 需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">5.2 程序执行流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">5.3 代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E6%A0%B9%E6%8D%AEID%E6%9F%A5%E8%AF%A2"><span class="toc-text">5.3.1 根据ID查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-%E4%BF%AE%E6%94%B9%E5%91%98%E5%B7%A5"><span class="toc-text">5.3.2 修改员工</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-text">5.4 功能测试</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/17.html" title="Docker实用篇"><img src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker实用篇"/></a><div class="content"><a class="title" href="/archives/17.html" title="Docker实用篇">Docker实用篇</a><time datetime="2023-07-13T02:47:45.000Z" title="发表于 2023-07-13 10:47:45">2023-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/16.html" title="Nacos集群搭建"><img src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nacos集群搭建"/></a><div class="content"><a class="title" href="/archives/16.html" title="Nacos集群搭建">Nacos集群搭建</a><time datetime="2023-07-12T09:24:45.000Z" title="发表于 2023-07-12 17:24:45">2023-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/15.html" title="Nacos安装指南"><img src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nacos安装指南"/></a><div class="content"><a class="title" href="/archives/15.html" title="Nacos安装指南">Nacos安装指南</a><time datetime="2023-07-12T02:50:45.000Z" title="发表于 2023-07-12 10:50:45">2023-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/14.html" title="SpringCloud02"><img src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringCloud02"/></a><div class="content"><a class="title" href="/archives/14.html" title="SpringCloud02">SpringCloud02</a><time datetime="2023-07-04T02:50:45.000Z" title="发表于 2023-07-04 10:50:45">2023-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/13.html" title="SpringCloud01"><img src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringCloud01"/></a><div class="content"><a class="title" href="/archives/13.html" title="SpringCloud01">SpringCloud01</a><time datetime="2023-07-03T02:50:45.000Z" title="发表于 2023-07-03 10:50:45">2023-07-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 姜小白</div><div class="footer_custom_text"><div>很高兴认识你</div><div>欢迎来到我的博客</div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script data-pjax defer src="https://npm.elemecdn.com/tzy-blog/lib/js/theme/chocolate.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.6534116,27.96920845';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 380px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 320px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>